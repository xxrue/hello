<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Operasi Set: Persilangan Set</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap');
    
    body {
      box-sizing: border-box;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 50%, #c2e9fb 100%);
      min-height: 100%;
      width: 100%;
    }
    
    .main-wrapper {
      width: 100%;
      min-height: 100%;
      padding: 40px 20px;
    }
    
    .content-container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 30px;
      align-items: start;
    }
    
    .left-panel {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 24px;
      padding: 36px;
      box-shadow: 0 20px 60px rgba(251, 194, 235, 0.3);
      position: sticky;
      top: 20px;
      border: 2px solid rgba(255, 255, 255, 0.8);
    }
    
    header {
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 4px solid #fbc2eb;
    }

    .language-toggle {
      display: flex;
      background: linear-gradient(135deg, #fff9fd, #f5faff);
      border-radius: 12px;
      padding: 4px;
      border: 3px solid #fde2f3;
      box-shadow: 0 4px 12px rgba(251, 194, 235, 0.2);
      margin-bottom: 20px;
      width: fit-content;
    }

    .language-toggle button {
      padding: 8px 16px;
      font-size: 13px;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 1px;
      background: transparent;
      color: #b08db5;
    }

    .language-toggle button.active {
      background: linear-gradient(135deg, #fbc2eb 0%, #d998c5 100%);
      color: #6b4c7a;
      box-shadow: 0 2px 8px rgba(251, 194, 235, 0.4);
    }

    .language-toggle button:hover:not(.active) {
      color: #6b4c7a;
    }
    
    h1 {
      color: #6b4c7a;
      font-size: 32px;
      margin: 0 0 12px 0;
      font-weight: 900;
      line-height: 1.2;
      letter-spacing: -0.5px;
    }
    
    .instruction {
      color: #8b7a9e;
      font-size: 15px;
      margin: 0;
      line-height: 1.6;
      font-weight: 500;
    }
    
    .legend {
      margin-bottom: 32px;
      padding: 24px;
      background: linear-gradient(135deg, #fff5fc, #f0f7ff);
      border-radius: 16px;
      border: 2px solid #fde2f3;
    }
    
    .legend h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      color: #6b4c7a;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 10px 0;
      font-size: 15px;
      color: #6b4c7a;
      font-weight: 600;
    }
    
    .legend-symbol {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 8px;
      font-weight: 800;
      font-size: 18px;
      color: #d998c5;
      box-shadow: 0 4px 8px rgba(251, 194, 235, 0.3);
    }
    
    .legend-divider {
      margin: 16px 0;
      padding-top: 16px;
      border-top: 2px solid #fde2f3;
    }
    
    .expression-section {
      margin-bottom: 32px;
    }
    
    .expression-label {
      font-size: 14px;
      font-weight: 800;
      color: #6b4c7a;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .expression-builder {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      padding: 20px;
      background: linear-gradient(135deg, #fff9fd, #f5faff);
      border-radius: 16px;
      border: 3px solid #fde2f3;
    }
    
    select {
      padding: 12px 16px;
      border: 3px solid #f9d5ef;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 75px;
      color: #6b4c7a;
    }
    
    select:hover {
      border-color: #fbc2eb;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(251, 194, 235, 0.4);
    }
    
    select:focus {
      outline: none;
      border-color: #fbc2eb;
      box-shadow: 0 0 0 4px rgba(251, 194, 235, 0.2);
    }
    
    .expression-display {
      margin-bottom: 24px;
      padding: 24px;
      background: linear-gradient(135deg, #fff, #fef5fb);
      border-radius: 16px;
      border: 3px solid #fbc2eb;
      box-shadow: 0 8px 20px rgba(251, 194, 235, 0.3);
      text-align: center;
    }

    .expression-display-label {
      font-size: 12px;
      font-weight: 800;
      color: #b08db5;
      text-transform: uppercase;
      letter-spacing: 1.5px;
      margin-bottom: 12px;
    }

    .expression-display-text {
      font-size: 28px;
      font-weight: 900;
      color: #6b4c7a;
      font-family: 'Poppins', sans-serif;
      letter-spacing: 2px;
      line-height: 1.4;
      word-break: break-word;
    }

    .button-group {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    
    button {
      width: 100%;
      padding: 18px 28px;
      font-size: 16px;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 1.2px;
    }
    
    .btn-show {
      background: linear-gradient(135deg, #fbc2eb 0%, #d998c5 100%);
      color: #6b4c7a;
      box-shadow: 0 6px 16px rgba(251, 194, 235, 0.5);
    }
    
    .btn-show:hover {
      background: linear-gradient(135deg, #f9aedd 0%, #d085b8 100%);
      transform: translateY(-3px);
      box-shadow: 0 10px 24px rgba(251, 194, 235, 0.6);
    }
    
    .btn-show:active {
      transform: translateY(0);
    }
    
    .btn-reset {
      background: linear-gradient(135deg, #e3f2fd, #bbdefb);
      color: #4a7ba7;
      border: 3px solid #c2e9fb;
    }
    
    .btn-reset:hover {
      background: linear-gradient(135deg, #d1e9fc, #a6d4f7);
      border-color: #a6c1ee;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(166, 193, 238, 0.4);
    }
    
    .venn-container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 24px;
      padding: 60px;
      box-shadow: 0 20px 60px rgba(251, 194, 235, 0.3);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 650px;
      border: 2px solid rgba(255, 255, 255, 0.8);
    }
    
    svg {
      max-width: 100%;
      height: auto;
    }
    
    .set-circle {
      fill: none;
      stroke-width: 4;
      transition: all 0.5s ease;
    }
    
    .set-label {
      font-size: 32px;
      font-weight: 900;
      font-family: 'Poppins', sans-serif;
    }
    
    .region {
      transition: all 0.5s ease;
      opacity: 0;
    }
    
    .region.active {
      opacity: 0.75;
    }
    
    @media (max-width: 1200px) {
      .content-container {
        grid-template-columns: 1fr;
      }
      
      .left-panel {
        position: relative;
        top: 0;
      }
    }
    
    @media (max-width: 768px) {
      .main-wrapper {
        padding: 20px 16px;
      }
      
      h1 {
        font-size: 26px;
      }
      
      .instruction {
        font-size: 14px;
      }
      
      .left-panel {
        padding: 28px;
      }
      
      .venn-container {
        padding: 32px;
        min-height: 450px;
      }
      
      .expression-builder {
        gap: 8px;
      }
      
      select {
        min-width: 65px;
        font-size: 16px;
        padding: 10px 12px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <main class="main-wrapper">
   <div class="content-container">
    <aside class="left-panel">
     <header>
      <div class="language-toggle"><button id="langBM" class="active" aria-label="Switch to Malay">BM</button> <button id="langENG" aria-label="Switch to English">ENG</button>
      </div>
      <h1 id="main-title">Operasi Set: Persilangan Set</h1>
      <p class="instruction" id="instruction-text">Pilih operasi untuk setiap set dan klik 'Tunjukkan Hasil' untuk melihat persilangan</p>
     </header>
     <div class="legend">
      <h3>Set Semesta (ξ)</h3>
      <div class="legend-item"><span class="legend-symbol" style="color: #f06292;">A</span> <span>Set A</span>
      </div>
      <div class="legend-item"><span class="legend-symbol" style="color: #81c784;">B</span> <span>Set B</span>
      </div>
      <div class="legend-item"><span class="legend-symbol" style="color: #64b5f6;">C</span> <span>Set C</span>
      </div>
      <div class="legend-divider">
       <div class="legend-item"><span class="legend-symbol">∩</span> <span>Persilangan</span>
       </div>
       <div class="legend-item"><span class="legend-symbol">∪</span> <span>Kesatuan</span>
       </div>
      </div>
     </div>
     <div class="expression-section">
      <div class="expression-label">
       Bina Ekspresi Set
      </div>
      <div class="expression-builder"><select id="setA" aria-label="Pilih Set A atau pelengkap A"> <option value="A">A</option> <option value="A'">A'</option> </select> <select id="operator1" aria-label="Pilih operasi pertama"> <option value="∩">∩</option> <option value="∪">∪</option> </select> <select id="setB" aria-label="Pilih Set B atau pelengkap B"> <option value="B">B</option> <option value="B'">B'</option> </select> <select id="operator2" aria-label="Pilih operasi kedua"> <option value="∩">∩</option> <option value="∪">∪</option> </select> <select id="setC" aria-label="Pilih Set C atau pelengkap C"> <option value="C">C</option> <option value="C'">C'</option> </select>
      </div>
     </div>
     <div class="expression-display" id="expressionDisplay">
      <div class="expression-display-label">
       Ekspresi Semasa
      </div>
      <div class="expression-display-text" id="expressionText">
       A ∩ B ∩ C
      </div>
     </div>
     <div class="button-group"><button class="btn-show" id="showBtn">Tunjukkan Hasil</button> <button class="btn-reset" id="resetBtn">Set Semula</button>
     </div>
    </aside>
    <div class="venn-container">
     <canvas id="vennCanvas" width="700" height="550" style="max-width: 100%; height: auto;"></canvas>
    </div>
   </div>
  </main>
  <script>
    const defaultConfig = {
      main_title: "Operasi Set: Persilangan Set",
      instruction_text: "Pilih operasi untuk setiap set dan klik 'Tunjukkan Hasil' untuk melihat persilangan",
      show_button: "Tunjukkan Hasil",
      reset_button: "Set Semula"
    };

    async function onConfigChange(config) {
      const titleElement = document.getElementById('main-title');
      const instructionElement = document.getElementById('instruction-text');
      const showBtnElement = document.getElementById('showBtn');
      const resetBtnElement = document.getElementById('resetBtn');
      
      if (titleElement) {
        titleElement.textContent = config.main_title || defaultConfig.main_title;
      }
      if (instructionElement) {
        instructionElement.textContent = config.instruction_text || defaultConfig.instruction_text;
      }
      if (showBtnElement) {
        showBtnElement.textContent = config.show_button || defaultConfig.show_button;
      }
      if (resetBtnElement) {
        resetBtnElement.textContent = config.reset_button || defaultConfig.reset_button;
      }
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["main_title", config.main_title || defaultConfig.main_title],
        ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
        ["show_button", config.show_button || defaultConfig.show_button],
        ["reset_button", config.reset_button || defaultConfig.reset_button]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }

    // Language translations
    const translations = {
      BM: {
        title: "Operasi Set: Persilangan Set",
        instruction: "Pilih operasi untuk setiap set dan klik 'Tunjukkan Hasil' untuk melihat persilangan",
        universalSet: "Set Semesta (ξ)",
        intersection: "Persilangan",
        union: "Kesatuan",
        buildExpression: "Bina Ekspresi Set",
        currentExpression: "Ekspresi Semasa",
        showResult: "Tunjukkan Hasil",
        reset: "Set Semula",
        selectA: "Pilih Set A atau pelengkap A",
        selectB: "Pilih Set B atau pelengkap B",
        selectC: "Pilih Set C atau pelengkap C",
        selectOp1: "Pilih operasi pertama",
        selectOp2: "Pilih operasi kedua"
      },
      ENG: {
        title: "Operations on Sets: Intersections of Sets",
        instruction: "Select operations for each set and click 'Show Result' to view the intersection",
        universalSet: "Universal Set (ξ)",
        intersection: "Intersection",
        union: "Union",
        buildExpression: "Build Set Expression",
        currentExpression: "Current Expression",
        showResult: "Show Result",
        reset: "Reset",
        selectA: "Select Set A or complement A",
        selectB: "Select Set B or complement B",
        selectC: "Select Set C or complement C",
        selectOp1: "Select first operation",
        selectOp2: "Select second operation"
      }
    };

    let currentLanguage = 'BM';

    // Venn diagram logic
    const canvas = document.getElementById('vennCanvas');
    const ctx = canvas.getContext('2d');
    const setASelect = document.getElementById('setA');
    const setBSelect = document.getElementById('setB');
    const setCSelect = document.getElementById('setC');
    const operator1Select = document.getElementById('operator1');
    const operator2Select = document.getElementById('operator2');
    const showBtn = document.getElementById('showBtn');
    const resetBtn = document.getElementById('resetBtn');
    const expressionText = document.getElementById('expressionText');
    const langBMBtn = document.getElementById('langBM');
    const langENGBtn = document.getElementById('langENG');

    // Update language function
    function updateLanguage(lang) {
      currentLanguage = lang;
      const t = translations[lang];
      
      // Update title and instruction
      document.getElementById('main-title').textContent = t.title;
      document.getElementById('instruction-text').textContent = t.instruction;
      
      // Update legend
      document.querySelector('.legend h3').textContent = t.universalSet;
      document.querySelectorAll('.legend-item span:last-child')[3].textContent = t.intersection;
      document.querySelectorAll('.legend-item span:last-child')[4].textContent = t.union;
      
      // Update expression section
      document.querySelector('.expression-label').textContent = t.buildExpression;
      document.querySelector('.expression-display-label').textContent = t.currentExpression;
      
      // Update buttons
      document.getElementById('showBtn').textContent = t.showResult;
      document.getElementById('resetBtn').textContent = t.reset;
      
      // Update aria labels
      setASelect.setAttribute('aria-label', t.selectA);
      setBSelect.setAttribute('aria-label', t.selectB);
      setCSelect.setAttribute('aria-label', t.selectC);
      operator1Select.setAttribute('aria-label', t.selectOp1);
      operator2Select.setAttribute('aria-label', t.selectOp2);
      
      // Update toggle buttons
      langBMBtn.classList.toggle('active', lang === 'BM');
      langENGBtn.classList.toggle('active', lang === 'ENG');
    }

    // Update expression display
    function updateExpression() {
      const setA = setASelect.value;
      const setB = setBSelect.value;
      const setC = setCSelect.value;
      const op1 = operator1Select.value;
      const op2 = operator2Select.value;
      
      expressionText.textContent = `${setA} ${op1} ${setB} ${op2} ${setC}`;
    }

    // Language toggle event listeners
    langBMBtn.addEventListener('click', () => updateLanguage('BM'));
    langENGBtn.addEventListener('click', () => updateLanguage('ENG'));

    // Add event listeners to update expression on change
    setASelect.addEventListener('change', updateExpression);
    setBSelect.addEventListener('change', updateExpression);
    setCSelect.addEventListener('change', updateExpression);
    operator1Select.addEventListener('change', updateExpression);
    operator2Select.addEventListener('change', updateExpression);

    // Circle positions and radius - Pastel colors
    const circles = {
      A: { x: 280, y: 220, r: 120, color: '#f06292' },
      B: { x: 420, y: 220, r: 120, color: '#81c784' },
      C: { x: 350, y: 340, r: 120, color: '#64b5f6' }
    };

    // Check if a point is inside a circle
    function isInCircle(px, py, circle) {
      const dx = px - circle.x;
      const dy = py - circle.y;
      return (dx * dx + dy * dy) <= (circle.r * circle.r);
    }

    // Determine which region a point belongs to
    function getRegion(x, y) {
      const inA = isInCircle(x, y, circles.A);
      const inB = isInCircle(x, y, circles.B);
      const inC = isInCircle(x, y, circles.C);

      if (inA && inB && inC) return 'ABC';
      if (inA && inB && !inC) return 'AB';
      if (inA && !inB && inC) return 'AC';
      if (!inA && inB && inC) return 'BC';
      if (inA && !inB && !inC) return 'A';
      if (!inA && inB && !inC) return 'B';
      if (!inA && !inB && inC) return 'C';
      return 'outside';
    }

    // Draw the Venn diagram
    function drawVenn(highlightRegions = []) {
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw universal set boundary
      ctx.strokeStyle = '#dfc4e8';
      ctx.lineWidth = 3;
      ctx.setLineDash([8, 5]);
      ctx.strokeRect(60, 60, 580, 430);
      ctx.setLineDash([]);

      // Define region colors - Pastel theme
      const regionColors = {
        'A': '#ffb3d9',
        'B': '#b3f5d9',
        'C': '#b3d9ff',
        'AB': '#e8b3f0',
        'AC': '#ffc9e3',
        'BC': '#9fe6d4',
        'ABC': '#d9c3f0',
        'outside': '#f5e6f0'
      };

      // Draw highlighted regions using pixel-by-pixel approach
      if (highlightRegions.length > 0) {
        const imageData = ctx.createImageData(canvas.width, canvas.height);
        const data = imageData.data;

        for (let y = 0; y < canvas.height; y++) {
          for (let x = 0; x < canvas.width; x++) {
            const region = getRegion(x, y);
            const idx = (y * canvas.width + x) * 4;

            if (highlightRegions.includes(region)) {
              const color = regionColors[region];
              const rgb = hexToRgb(color);
              data[idx] = rgb.r;
              data[idx + 1] = rgb.g;
              data[idx + 2] = rgb.b;
              data[idx + 3] = 190; // Alpha (75% opacity)
            }
          }
        }

        ctx.putImageData(imageData, 0, 0);
      }

      // Draw circles
      Object.keys(circles).forEach(key => {
        const circle = circles[key];
        ctx.beginPath();
        ctx.arc(circle.x, circle.y, circle.r, 0, Math.PI * 2);
        ctx.strokeStyle = circle.color;
        ctx.lineWidth = 4;
        ctx.stroke();
      });

      // Draw labels
      ctx.font = '900 32px Poppins, sans-serif';
      ctx.fillStyle = circles.A.color;
      ctx.fillText('A', 200, 150);
      ctx.fillStyle = circles.B.color;
      ctx.fillText('B', 480, 150);
      ctx.fillStyle = circles.C.color;
      ctx.fillText('C', 330, 450);

      // Draw universal set label (using ξ for universal set)
      ctx.font = '800 28px Georgia, serif';
      ctx.fillStyle = '#b08db5';
      ctx.fillText('ξ', 605, 85);
    }

    // Convert hex to RGB
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : { r: 0, g: 0, b: 0 };
    }

    // Map sets to regions
    const regionMap = {
      'A': ['A', 'AB', 'AC', 'ABC'],
      'B': ['B', 'AB', 'BC', 'ABC'],
      'C': ['C', 'AC', 'BC', 'ABC'],
      "A'": ['B', 'C', 'BC', 'outside'],
      "B'": ['A', 'C', 'AC', 'outside'],
      "C'": ['A', 'B', 'AB', 'outside']
    };

    function intersect(arr1, arr2) {
      return arr1.filter(x => arr2.includes(x));
    }

    function union(arr1, arr2) {
      return [...new Set([...arr1, ...arr2])];
    }

    showBtn.addEventListener('click', () => {
      const setA = setASelect.value;
      const setB = setBSelect.value;
      const setC = setCSelect.value;
      const op1 = operator1Select.value;
      const op2 = operator2Select.value;

      // Get regions for each set
      let regionsA = regionMap[setA];
      let regionsB = regionMap[setB];
      let regionsC = regionMap[setC];

      // Apply first operation (A op1 B)
      let result = op1 === '∩' ? intersect(regionsA, regionsB) : union(regionsA, regionsB);

      // Apply second operation (result op2 C)
      result = op2 === '∩' ? intersect(result, regionsC) : union(result, regionsC);

      drawVenn(result);
    });

    resetBtn.addEventListener('click', () => {
      setASelect.value = 'A';
      setBSelect.value = 'B';
      setCSelect.value = 'C';
      operator1Select.value = '��';
      operator2Select.value = '∩';
      updateExpression();
      drawVenn([]);
    });

    // Initial draw
    drawVenn([]);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aa8a37ff536b4d0',t:'MTc2NTE1ODkwNy4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
