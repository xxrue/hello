<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Permainan Swipe Masalah Inventif</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Quicksand', 'Segoe UI', -apple-system, sans-serif;
      background: linear-gradient(180deg, #1a4d6d 0%, #0d3d56 50%, #0a2840 100%);
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    html {
      height: 100%;
    }

    /* Animated ocean waves */
    .wave {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 200%;
      height: 200px;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,50 C150,80 350,0 600,50 C850,100 1050,20 1200,50 L1200,120 L0,120 Z" fill="%234fb3d9" opacity="0.3"/></svg>') repeat-x;
      background-size: 600px 120px;
      animation: waveMove 15s linear infinite;
      pointer-events: none;
      z-index: 0;
    }

    .wave:nth-child(2) {
      bottom: -20px;
      opacity: 0.5;
      animation: waveMove 20s linear infinite reverse;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,30 C200,70 400,10 600,40 C800,70 1000,10 1200,40 L1200,120 L0,120 Z" fill="%231e5f7a" opacity="0.4"/></svg>') repeat-x;
      background-size: 600px 120px;
    }

    .wave:nth-child(3) {
      bottom: -40px;
      opacity: 0.7;
      animation: waveMove 25s linear infinite;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,60 C250,90 450,30 600,60 C750,90 950,30 1200,60 L1200,120 L0,120 Z" fill="%230d3d56" opacity="0.5"/></svg>') repeat-x;
      background-size: 600px 120px;
    }

    @keyframes waveMove {
      0% { transform: translateX(0); }
      100% { transform: translateX(-600px); }
    }

    /* Rising bubbles */
    .bubble {
      position: fixed;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.9), rgba(200, 240, 255, 0.5));
      box-shadow: 
        inset 0 -10px 20px rgba(255, 255, 255, 0.4),
        0 5px 15px rgba(0, 0, 0, 0.2);
      animation: bubbleRise 12s infinite ease-in;
      pointer-events: none;
      opacity: 0.8;
    }

    .clickable-bubble {
      pointer-events: auto;
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .clickable-bubble:hover {
      transform: scale(1.1);
    }

    @keyframes bubble-burst {
      0% {
        transform: scale(1);
        opacity: 1;
      }
      50% {
        transform: scale(1.3);
        opacity: 0.7;
      }
      100% {
        transform: scale(0);
        opacity: 0;
      }
    }

    @keyframes bubbleRise {
      0% { 
        transform: translateY(0) translateX(0) scale(0.8);
        opacity: 0;
      }
      10% {
        opacity: 0.8;
      }
      90% {
        opacity: 0.6;
      }
      100% { 
        transform: translateY(-100vh) translateX(50px) scale(1.2);
        opacity: 0;
      }
    }

    /* Twinkling sparkles */
    .sparkle {
      position: fixed;
      bottom: -20px;
      width: 6px;
      height: 6px;
      background: white;
      border-radius: 50%;
      box-shadow: 
        0 0 10px rgba(255, 255, 255, 0.8),
        0 0 20px rgba(255, 215, 0, 0.6),
        0 0 30px rgba(255, 105, 180, 0.4);
      animation: sparkleRise 15s infinite ease-in;
      pointer-events: none;
      opacity: 0;
    }

    @keyframes sparkleRise {
      0% { 
        transform: translateY(0) translateX(0) scale(0);
        opacity: 0;
      }
      5% {
        opacity: 1;
        transform: translateY(-50px) translateX(10px) scale(1);
      }
      15%, 25% {
        opacity: 1;
        transform: translateY(-15vh) translateX(30px) scale(1.2);
      }
      20% {
        opacity: 0.5;
      }
      35%, 45% {
        opacity: 1;
        transform: translateY(-35vh) translateX(-20px) scale(0.8);
      }
      40% {
        opacity: 0.4;
      }
      55%, 65% {
        opacity: 1;
        transform: translateY(-55vh) translateX(40px) scale(1.1);
      }
      60% {
        opacity: 0.6;
      }
      75%, 85% {
        opacity: 1;
        transform: translateY(-75vh) translateX(-30px) scale(0.9);
      }
      80% {
        opacity: 0.5;
      }
      95% {
        opacity: 0.7;
        transform: translateY(-95vh) translateX(20px) scale(0.7);
      }
      100% { 
        transform: translateY(-100vh) translateX(50px) scale(0);
        opacity: 0;
      }
    }

    .game-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 20px;
      position: relative;
      z-index: 1;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 20px;
      animation: floatDown 0.8s ease;
    }

    @keyframes floatDown {
      from { opacity: 0; transform: translateY(-40px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .game-title {
      font-size: 32px;
      font-weight: 900;
      margin-bottom: 15px;
      text-shadow: 
        0 1px 0 #4fb3d9,
        0 2px 0 #3d9ac2,
        0 3px 0 #2c82ab,
        0 4px 0 #1a6994,
        0 5px 0 #0d3d56,
        0 8px 20px rgba(0, 0, 0, 0.5),
        0 0 30px rgba(128, 222, 234, 0.6);
      animation: gentle-float 3s ease-in-out infinite;
      letter-spacing: 1px;
      transform: perspective(500px) rotateX(5deg);
      position: relative;
      z-index: 1;
    }

    @keyframes gentle-float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    .stats-bar {
      display: flex;
      gap: 15px;
      justify-content: center;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .stat-item {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(200, 240, 255, 0.2));
      padding: 12px 24px;
      border-radius: 50px;
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.15),
        inset 0 2px 10px rgba(255, 255, 255, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
      animation: bubble-pop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      border: 2px solid rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(10px);
    }

    .stat-item.timer-ring {
      padding: 10px;
    }

    .stat-item.stacked {
      flex-direction: column;
      padding: 10px 20px;
      gap: 4px;
    }

    .stat-item.stacked .stat-label {
      font-size: 13px;
    }

    .stat-item.stacked .stat-value {
      font-size: 20px;
    }

    .progress-ring {
      transform: rotate(-90deg);
    }

    .progress-ring-circle {
      transition: stroke-dashoffset 0.5s ease;
      stroke-dasharray: 150.8;
      stroke-dashoffset: 0;
      stroke-linecap: round;
      filter: drop-shadow(0 2px 8px rgba(79, 179, 217, 0.6));
    }

    .timer-label {
      font-size: 15px;
    }

    @keyframes bubble-pop {
      0% { transform: scale(0); opacity: 0; }
      70% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }

    .stat-label {
      font-size: 15px;
      font-weight: 700;
      color: rgba(255, 255, 255, 0.95);
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .stat-value {
      font-size: 24px;
      font-weight: 900;
      color: #ffe066;
      text-shadow: 
        0 2px 8px rgba(0, 0, 0, 0.3),
        0 0 15px rgba(255, 224, 102, 0.5);
    }

    .reminder-box {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.35), rgba(200, 240, 255, 0.25));
      padding: 20px 28px;
      border-radius: 25px;
      margin-bottom: 20px;
      max-width: 700px;
      box-shadow: 
        0 8px 30px rgba(0, 0, 0, 0.15),
        inset 0 2px 15px rgba(255, 255, 255, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.4);
      backdrop-filter: blur(15px);
    }

    .reminder-title {
      font-size: 16px;
      font-weight: 800;
      color: #ffe066;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .reminder-text {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.98);
      line-height: 1.7;
      font-weight: 600;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }

    .reminder-line {
      display: block;
      margin-bottom: 6px;
    }

    .reminder-line:last-child {
      margin-bottom: 0;
    }

    .reminder-text strong {
      font-weight: 900;
      padding: 3px 8px;
      border-radius: 6px;
      color: #ffffff;
    }
    
    .reminder-text strong:nth-of-type(1) {
      background: transparent;
      color: #ffffff;
      text-shadow: 
        0 0 10px rgba(173, 216, 230, 0.8),
        0 0 20px rgba(173, 216, 230, 0.6),
        0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .reminder-text strong:nth-of-type(2) {
      background: transparent;
      color: #ffffff;
      text-shadow: 
        0 0 10px rgba(255, 182, 193, 0.8),
        0 0 20px rgba(255, 182, 193, 0.6),
        0 2px 4px rgba(0, 0, 0, 0.3);
    }
    
    .reminder-text strong:nth-of-type(3) {
      background: transparent;
      color: #ffffff;
      text-shadow: 
        0 0 10px rgba(221, 160, 221, 0.8),
        0 0 20px rgba(221, 160, 221, 0.6),
        0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Particle trail */
    .particle {
      position: fixed;
      pointer-events: none;
      border-radius: 50%;
      animation: particle-fade 0.8s ease-out forwards;
      z-index: 500;
    }

    @keyframes particle-fade {
      0% {
        opacity: 1;
        transform: scale(1);
      }
      100% {
        opacity: 0;
        transform: scale(0.3) translateY(-30px);
      }
    }

    .card-area {
      position: relative;
      width: 100%;
      max-width: 450px;
      height: 500px;
      margin-bottom: 20px;
    }

    .card {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.95) 0%, 
        rgba(224, 247, 255, 0.95) 50%,
        rgba(179, 229, 252, 0.95) 100%);
      border-radius: 35px;
      padding: 40px;
      box-shadow: 
        0 25px 60px rgba(0, 0, 0, 0.25),
        0 10px 30px rgba(30, 95, 122, 0.3),
        inset 0 -5px 20px rgba(255, 255, 255, 0.5),
        inset 0 5px 20px rgba(79, 179, 217, 0.2);
      cursor: grab;
      user-select: none;
      transition: transform 0.1s ease, box-shadow 0.3s ease;
      display: flex;
      flex-direction: column;
      justify-content: center;
      border: 3px solid rgba(255, 255, 255, 0.6);
      animation: card-float-in 1s cubic-bezier(0.34, 1.56, 0.64, 1);
      backdrop-filter: blur(10px);
      touch-action: none;
      will-change: transform;
    }

    @keyframes card-float-in {
      0% { 
        transform: translateY(100px) scale(0.8);
        opacity: 0;
      }
      60% {
        transform: translateY(-20px) scale(1.05);
      }
      100% { 
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }

    .card:active {
      cursor: grabbing;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 10px;
      left: 10px;
      right: 10px;
      bottom: 10px;
      border-radius: 25px;
      background: linear-gradient(135deg, 
        rgba(128, 222, 234, 0.2), 
        rgba(79, 179, 217, 0.2));
      animation: wave-pulse 3s ease-in-out infinite;
    }

    @keyframes wave-pulse {
      0%, 100% { 
        opacity: 0.3;
        transform: scale(1);
      }
      50% { 
        opacity: 0.6;
        transform: scale(1.02);
      }
    }

    .card-content {
      font-size: 19px;
      line-height: 1.8;
      color: #0d3d56;
      text-align: center;
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
      position: relative;
      z-index: 1;
    }

    .swipe-indicators {
      display: flex;
      justify-content: space-between;
      width: 100%;
      max-width: 600px;
      margin-top: 20px;
      gap: 20px;
    }

    .swipe-hint {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      border-radius: 50px;
      font-weight: 700;
      box-shadow: 
        0 4px 15px rgba(0, 0, 0, 0.15),
        inset 0 2px 8px rgba(255, 255, 255, 0.3);
      border: 2px solid;
      backdrop-filter: blur(15px);
      transition: all 0.3s ease;
      font-size: 15px;
      position: relative;
      overflow: hidden;
    }

    .swipe-hint::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.3) 0%, transparent 70%);
      opacity: 0.5;
      pointer-events: none;
    }

    .swipe-hint.left {
      background: radial-gradient(circle at 30% 30%, rgba(168, 85, 247, 0.4), rgba(138, 43, 226, 0.35));
      color: white;
      border-color: rgba(255, 255, 255, 0.5);
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    .swipe-hint.left:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 6px 20px rgba(138, 43, 226, 0.4),
        inset 0 2px 10px rgba(255, 255, 255, 0.4);
    }

    .swipe-hint.right {
      background: radial-gradient(circle at 30% 30%, rgba(244, 114, 182, 0.4), rgba(236, 64, 122, 0.35));
      color: white;
      border-color: rgba(255, 255, 255, 0.5);
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
    }

    .swipe-hint.right:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 6px 20px rgba(236, 64, 122, 0.4),
        inset 0 2px 10px rgba(255, 255, 255, 0.4);
    }

    .swipe-arrow {
      font-size: 20px;
    }

    .feedback {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 120px;
      font-weight: 900;
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
      text-shadow: 
        0 5px 20px rgba(0, 0, 0, 0.3),
        0 0 40px currentColor;
    }

    .feedback.correct {
      color: #4caf50;
    }

    .feedback.wrong {
      color: #f44336;
    }

    .feedback.show {
      animation: splash-feedback 1s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    @keyframes splash-feedback {
      0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(0) rotate(-30deg);
      }
      50% { 
        opacity: 1; 
        transform: translate(-50%, -50%) scale(1.3) rotate(5deg);
      }
      100% { 
        opacity: 0; 
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
      }
    }

    .score-popup {
      position: fixed;
      top: 20%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 64px;
      font-weight: 900;
      opacity: 0;
      pointer-events: none;
      z-index: 1000;
      text-shadow: 
        0 3px 10px rgba(0, 0, 0, 0.3),
        0 0 30px currentColor;
    }

    .score-popup.show {
      animation: bubble-float 1.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .score-popup.positive {
      color: #4caf50;
    }

    .score-popup.negative {
      color: #f44336;
    }

    @keyframes bubble-float {
      0% { 
        opacity: 0; 
        transform: translate(-50%, -50%) translateY(0) scale(0.3);
      }
      30% { 
        opacity: 1; 
        transform: translate(-50%, -50%) translateY(-30px) scale(1.2);
      }
      100% { 
        opacity: 0; 
        transform: translate(-50%, -50%) translateY(-140px) scale(0.8);
      }
    }

    .scoreboard {
      display: none;
      text-align: center;
      color: white;
      max-width: 600px;
      animation: surface-pop 1s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    @keyframes surface-pop {
      0% { 
        transform: translateY(100px) scale(0.5);
        opacity: 0;
      }
      100% { 
        transform: translateY(0) scale(1);
        opacity: 1;
      }
    }

    .scoreboard.show {
      display: block;
    }

    .scoreboard-title {
      font-size: 42px;
      font-weight: 900;
      margin-bottom: 30px;
      text-shadow: 
        0 3px 15px rgba(0, 0, 0, 0.3),
        0 0 30px rgba(255, 255, 255, 0.5);
      animation: color-wave 4s ease-in-out infinite;
    }

    @keyframes color-wave {
      0% { color: #80deea; }
      25% { color: #4fb3d9; }
      50% { color: #ff8a65; }
      75% { color: #ffe066; }
      100% { color: #80deea; }
    }

    .scoreboard-content {
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.95) 0%, 
        rgba(224, 247, 255, 0.95) 100%);
      padding: 50px;
      border-radius: 35px;
      box-shadow: 
        0 25px 70px rgba(0, 0, 0, 0.3),
        inset 0 -5px 20px rgba(255, 255, 255, 0.5),
        inset 0 5px 20px rgba(79, 179, 217, 0.2);
      border: 4px solid rgba(255, 255, 255, 0.6);
    }

    .final-score {
      font-size: 96px;
      font-weight: 900;
      background: linear-gradient(135deg, #4fb3d9, #80deea, #4caf50);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 25px;
      animation: score-pulse 2s ease-in-out infinite;
      filter: drop-shadow(0 5px 15px rgba(79, 179, 217, 0.4));
    }

    @keyframes score-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.08); }
    }

    .scoreboard-stats {
      font-size: 18px;
      color: #0d3d56;
      margin-bottom: 12px;
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }

    .restart-btn {
      margin-top: 35px;
      padding: 20px 55px;
      font-size: 20px;
      font-weight: 800;
      background: linear-gradient(135deg, #4fb3d9 0%, #80deea 100%);
      color: white;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.2),
        inset 0 -3px 0 rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      border: 3px solid rgba(255, 255, 255, 0.5);
    }

    .restart-btn:hover {
      transform: translateY(-5px) scale(1.05);
      box-shadow: 
        0 15px 45px rgba(0, 0, 0, 0.3),
        0 0 30px rgba(79, 179, 217, 0.5);
    }

    .restart-btn:active {
      transform: translateY(-2px) scale(1.02);
    }

    .back-to-menu-btn {
      padding: 12px 24px;
      font-size: 15px;
      font-weight: 700;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(200, 240, 255, 0.2));
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.4);
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.15),
        inset 0 2px 10px rgba(255, 255, 255, 0.3);
      transition: all 0.3s ease;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
      display: none;
      animation: bubble-pop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    .back-to-menu-btn.show {
      display: inline-block;
    }

    .back-to-menu-btn:hover {
      transform: translateY(-2px);
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.2),
        inset 0 2px 15px rgba(255, 255, 255, 0.4);
    }

    .back-to-menu-btn:active {
      transform: translateY(0);
    }

    canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
    }

    .question-indicator {
      font-size: 17px;
      font-weight: 800;
      color: #ffe066;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(200, 240, 255, 0.2));
      padding: 10px 22px;
      border-radius: 50px;
      box-shadow: 
        0 8px 25px rgba(0, 0, 0, 0.15),
        inset 0 2px 10px rgba(255, 255, 255, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.4);
      animation: bubble-pop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      backdrop-filter: blur(10px);
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .start-screen {
      text-align: center;
      color: white;
      max-width: 650px;
      animation: wave-in 1s ease;
    }

    @keyframes wave-in {
      from { opacity: 0; transform: translateY(50px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .start-title {
      font-size: 42px;
      font-weight: 900;
      margin-bottom: 25px;
      text-shadow: 
        0 1px 0 #4fb3d9,
        0 2px 0 #3d9ac2,
        0 3px 0 #2c82ab,
        0 4px 0 #1a6994,
        0 5px 0 #0d3d56,
        0 6px 0 #073348,
        0 10px 25px rgba(0, 0, 0, 0.6),
        0 0 40px rgba(128, 222, 234, 0.8);
      animation: gentle-float 3s ease-in-out infinite;
      line-height: 1.4;
      letter-spacing: 1px;
      transform: perspective(500px) rotateX(5deg);
    }

    .start-instructions {
      background: linear-gradient(135deg, 
        rgba(255, 255, 255, 0.95) 0%, 
        rgba(224, 247, 255, 0.95) 100%);
      padding: 35px;
      border-radius: 30px;
      margin-bottom: 35px;
      box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.25),
        inset 0 -5px 20px rgba(255, 255, 255, 0.5),
        inset 0 5px 20px rgba(79, 179, 217, 0.2);
      text-align: left;
      border: 4px solid rgba(255, 255, 255, 0.6);
    }

    .instruction-item {
      margin-bottom: 18px;
      color: #0d3d56;
      font-size: 17px;
      line-height: 1.7;
      font-weight: 700;
      animation: slide-wave 0.8s ease backwards;
      text-shadow: 0 1px 2px rgba(255, 255, 255, 0.8);
    }

    .instruction-item:nth-child(1) { animation-delay: 0.1s; }
    .instruction-item:nth-child(2) { animation-delay: 0.2s; }
    .instruction-item:nth-child(3) { animation-delay: 0.3s; }
    .instruction-item:nth-child(4) { animation-delay: 0.4s; }
    .instruction-item:nth-child(5) { animation-delay: 0.5s; }
    .instruction-item:nth-child(6) { animation-delay: 0.6s; }

    @keyframes slide-wave {
      from { opacity: 0; transform: translateX(-40px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .instruction-item strong {
      color: #1a6994;
      font-weight: 900;
    }

    .start-btn {
      padding: 22px 65px;
      font-size: 24px;
      font-weight: 900;
      background: linear-gradient(135deg, #4fb3d9 0%, #80deea 100%);
      color: white;
      border: 4px solid rgba(255, 255, 255, 0.6);
      border-radius: 50px;
      cursor: pointer;
      box-shadow: 
        0 12px 35px rgba(0, 0, 0, 0.25),
        inset 0 -4px 0 rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      animation: glow-pulse 2.5s ease-in-out infinite;
    }

    @keyframes glow-pulse {
      0%, 100% { 
        box-shadow: 
          0 12px 35px rgba(0, 0, 0, 0.25),
          0 0 20px rgba(79, 179, 217, 0.5);
      }
      50% { 
        box-shadow: 
          0 12px 35px rgba(0, 0, 0, 0.25),
          0 0 40px rgba(79, 179, 217, 0.8);
      }
    }

    .start-btn:hover {
      transform: translateY(-8px) scale(1.05);
      box-shadow: 
        0 18px 50px rgba(0, 0, 0, 0.3),
        0 0 50px rgba(79, 179, 217, 1);
    }

    .start-btn:active {
      transform: translateY(-4px) scale(1.02);
    }

    .combo-indicator {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, 
        rgba(255, 138, 101, 0.95) 0%, 
        rgba(255, 112, 67, 0.95) 100%);
      padding: 16px 28px;
      border-radius: 50px;
      font-size: 22px;
      font-weight: 900;
      color: white;
      text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      box-shadow: 
        0 10px 40px rgba(0, 0, 0, 0.3),
        0 0 30px rgba(255, 112, 67, 0.6),
        inset 0 2px 15px rgba(255, 255, 255, 0.3);
      border: 3px solid rgba(255, 255, 255, 0.5);
      opacity: 0;
      transform: scale(0);
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      z-index: 1001;
      backdrop-filter: blur(10px);
    }

    .combo-indicator.show {
      opacity: 1;
      transform: scale(1);
      animation: combo-bounce 0.6s ease-in-out infinite;
    }

    @keyframes combo-bounce {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.08) rotate(-3deg); }
      75% { transform: scale(1.08) rotate(3deg); }
    }



    /* Mobile responsive */
    @media (max-width: 768px) {
      .game-title {
        font-size: 16px;
        margin-bottom: 10px;
        padding: 0 80px;
      }

      .start-title {
        font-size: 26px;
      }

      .header {
        margin-bottom: 15px;
      }

      .stats-bar {
        gap: 8px;
        flex-wrap: nowrap;
        justify-content: center;
        margin-bottom: 12px;
      }

      .stat-item {
        padding: 8px 14px;
      }

      .stat-item.stacked {
        padding: 8px 12px;
      }

      .stat-item.timer-ring {
        padding: 6px;
      }

      .progress-ring {
        width: 44px;
        height: 44px;
      }

      .progress-ring circle {
        r: 18;
        cx: 22;
        cy: 22;
      }

      .stat-label {
        font-size: 11px;
      }

      .stat-value {
        font-size: 16px;
      }

      .timer-label {
        font-size: 11px;
      }

      .question-indicator {
        font-size: 13px;
        padding: 6px 12px;
      }

      .reminder-box {
        padding: 14px 18px;
        max-width: 100%;
        margin-bottom: 15px;
      }

      .reminder-title {
        font-size: 13px;
        margin-bottom: 8px;
      }

      .reminder-text {
        font-size: 11px;
        line-height: 1.7;
      }

      .reminder-line {
        margin-bottom: 8px;
      }

      .card-area {
        max-width: 320px;
        height: 420px;
        margin-bottom: 15px;
      }

      .card {
        padding: 25px;
      }

      .card-content {
        font-size: 15px;
        line-height: 1.6;
      }

      .swipe-indicators {
        max-width: 100%;
        gap: 8px;
        margin-top: 15px;
      }

      .swipe-hint {
        padding: 10px 16px;
        font-size: 12px;
      }

      .swipe-arrow {
        font-size: 18px;
      }

      .start-instructions {
        padding: 24px;
      }

      .instruction-item {
        font-size: 13px;
        margin-bottom: 12px;
      }

      .start-btn {
        padding: 16px 45px;
        font-size: 18px;
      }

      .feedback {
        font-size: 80px;
      }

      .score-popup {
        font-size: 48px;
      }

      .final-score {
        font-size: 64px;
      }

      .scoreboard-title {
        font-size: 32px;
        margin-bottom: 20px;
      }

      .scoreboard-content {
        padding: 32px 24px;
      }

      .scoreboard-stats {
        font-size: 16px;
      }

      .restart-btn {
        padding: 16px 45px;
        font-size: 18px;
      }

      .combo-indicator {
        top: 20px;
        right: 20px;
        padding: 10px 18px;
        font-size: 16px;
      }
    }

    @media (max-width: 480px) {
      .game-title {
        font-size: 18px;
      }

      .start-title {
        font-size: 24px;
      }

      .card-area {
        max-width: 300px;
        height: 400px;
      }

      .card {
        padding: 25px;
      }

      .card-content {
        font-size: 14px;
      }

      .swipe-hint {
        padding: 12px 18px;
        font-size: 12px;
      }

      .swipe-arrow {
        font-size: 22px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body><!-- Ocean waves -->
  <div class="wave"></div>
  <div class="wave"></div>
  <div class="wave"></div><!-- Rising bubbles - clickable -->
  <div class="bubble clickable-bubble" style="width: 60px; height: 60px; bottom: -100px; left: 15%;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 40px; height: 40px; bottom: -100px; right: 20%; animation-delay: 3s;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 80px; height: 80px; bottom: -100px; left: 45%; animation-delay: 6s;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 50px; height: 50px; bottom: -100px; right: 10%; animation-delay: 9s;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 35px; height: 35px; bottom: -100px; left: 70%; animation-delay: 4s;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 65px; height: 65px; bottom: -100px; right: 35%; animation-delay: 7s;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 45px; height: 45px; bottom: -100px; left: 25%; animation-delay: 2s;" onclick="burstBubble(event)"></div>
  <div class="bubble clickable-bubble" style="width: 55px; height: 55px; bottom: -100px; right: 50%; animation-delay: 5s;" onclick="burstBubble(event)"></div><!-- Twinkling sparkles -->
  <div class="sparkle" style="left: 10%; animation-delay: 0s;"></div>
  <div class="sparkle" style="left: 22%; animation-delay: 2s;"></div>
  <div class="sparkle" style="left: 35%; animation-delay: 4s;"></div>
  <div class="sparkle" style="left: 48%; animation-delay: 1s;"></div>
  <div class="sparkle" style="left: 60%; animation-delay: 3s;"></div>
  <div class="sparkle" style="left: 73%; animation-delay: 5s;"></div>
  <div class="sparkle" style="left: 85%; animation-delay: 2.5s;"></div>
  <div class="sparkle" style="left: 18%; animation-delay: 4.5s;"></div>
  <div class="sparkle" style="left: 42%; animation-delay: 1.5s;"></div>
  <div class="sparkle" style="left: 67%; animation-delay: 3.5s;"></div>
  <div class="sparkle" style="left: 92%; animation-delay: 0.5s;"></div>
  <div class="sparkle" style="left: 8%; animation-delay: 5.5s;"></div>
  <canvas id="confetti"></canvas>
  <div class="combo-indicator" id="comboIndicator">
   üî• COMBO!
  </div>
  <div class="game-container"><!-- Start Screen -->
   <div class="start-screen" id="startScreen">
    <div class="start-title" id="gameTitle">
     Masalah Inventif dan Masalah Bukan Inventif
    </div>
    <div class="start-instructions">
     <div class="instruction-item">
      üìã <strong>Arahan:</strong> Tekan kad dan swipe ke kiri atau kanan untuk menjawab
     </div>
     <div class="instruction-item">
      üéØ <strong>Objektif:</strong> Jawab sebanyak mungkin soalan dalam masa 1 minit 30 saat
     </div>
     <div class="instruction-item">
      ‚¨ÖÔ∏è <strong>Swipe Kiri:</strong> Masalah Bukan Inventif (Tiada kesan sampingan)
     </div>
     <div class="instruction-item">
      ‚û°Ô∏è <strong>Swipe Kanan:</strong> Masalah Inventif (Ada kesan sampingan)
     </div>
     <div class="instruction-item">
      ‚úÖ <strong>Jawapan Betul:</strong> +5 markah &amp; +5 saat bonus
     </div>
     <div class="instruction-item">
      ‚ùå <strong>Jawapan Salah:</strong> -2 markah
     </div>
     <div class="instruction-item">
      üî• <strong>Combo:</strong> Jawab betul berturut-turut dapat 10 markah!
     </div>
    </div><button class="start-btn" onclick="startGame()">Mula Permainan</button>
   </div><!-- Game Screen -->
   <div class="header" id="gameHeader" style="display: none;">
    <div class="game-title" id="headerTitle">
     Masalah Inventif dan Masalah Bukan Inventif
    </div>
    <div class="stats-bar"><button class="back-to-menu-btn" id="backToMenuBtn" onclick="backToMenu()">‚Üê Menu</button>
     <div class="stat-item timer-ring">
      <svg class="progress-ring" width="60" height="60"><circle class="progress-ring-circle-bg" stroke="rgba(255,255,255,0.3)" stroke-width="4" fill="transparent" r="24" cx="30" cy="30" /> <circle class="progress-ring-circle" id="progressCircle" stroke="url(#gradient)" stroke-width="4" fill="transparent" r="24" cx="30" cy="30" /> <defs>
        <lineargradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
         <stop offset="0%" style="stop-color:#4fb3d9;stop-opacity:1" />
         <stop offset="100%" style="stop-color:#80deea;stop-opacity:1" />
        </lineargradient>
       </defs>
      </svg>
     </div>
     <div class="stat-item stacked"><span class="stat-label timer-label" id="timerLabel">‚è±Ô∏è Masa</span> <span class="stat-value" id="timer">90</span>
     </div>
     <div class="stat-item stacked"><span class="stat-label" id="scoreLabel">ÔøΩÔøΩ Skor</span> <span class="stat-value" id="score">0</span>
     </div>
     <div class="question-indicator"><span id="questionCount">1</span>/10
     </div>
    </div>
    <div class="reminder-box">
     <div class="reminder-title">
      üí° Petua Pantas
     </div>
     <div class="reminder-text"><span class="reminder-line"><strong>Arahan:</strong> Tekan kad dan swipe ke kiri atau kanan untuk menjawab</span> <span class="reminder-line"><strong>Masalah Inventif:</strong> Ada kesan sampingan selepas penambahbaikan</span> <span class="reminder-line"><strong>Masalah Bukan Inventif:</strong> Tiada kesan sampingan selepas penambahbaikan</span>
     </div>
    </div>
   </div>
   <div class="card-area" id="cardArea" style="display: none;">
    <div class="card" id="card">
     <div class="card-content" id="cardContent"></div>
    </div>
   </div>
   <div class="swipe-indicators" id="swipeIndicators" style="display: none;">
    <div class="swipe-hint left"><span class="swipe-arrow">‚¨ÖÔ∏è</span> <span>Masalah Bukan Inventif</span>
    </div>
    <div class="swipe-hint right"><span class="swipe-arrow">‚û°Ô∏è</span> <span>Masalah Inventif</span>
    </div>
   </div><!-- Scoreboard -->
   <div class="scoreboard" id="scoreboard">
    <div class="scoreboard-title">
     Tahniah! üéâ
    </div>
    <div class="scoreboard-content">
     <div class="final-score" id="finalScore">
      0
     </div>
     <div class="scoreboard-stats" id="questionsAnswered"></div>
     <div class="scoreboard-stats" id="timeTaken"></div>
     <div class="scoreboard-stats" id="accuracy"></div><button class="restart-btn" onclick="backToMenu()">Kembali ke Menu</button>
    </div>
   </div>
  </div>
  <div class="feedback" id="feedback"></div>
  <div class="score-popup" id="scorePopup"></div>
  <script>
    const defaultConfig = {
      game_title: "Masalah Inventif dan Masalah Bukan Inventif",
      timer_label: "Masa",
      score_label: "Skor",
      background_color: "#ff6b9d",
      card_color: "#ffffff",
      text_color: "#333333",
      primary_action_color: "#ff6b9d",
      accent_color: "#10b981"
    };

    const questions = [
      { text: "Penutup balang biskut yang tidak ketat menyebabkan biskut lemau. Penutup balang kuih ditambah baik, namun penutup menjadi terlalu ketat.", answer: "inventif" },
      { text: "Meja berkaki kayu tidak dapat menampung berat beban. Kaki meja diganti dengan kaki yang diperbuat daripada besi. Namun, meja itu menjadi lebih berat untuk dialihkan.", answer: "inventif" },
      { text: "Tali beg sekolah nipis dan sakit di bahu. Tali diganti dengan tali yang lebih tebal dan lebar. Namun, tali beg menjadi terlalu lebar untuk bahu dan lebih berat.", answer: "inventif" },
      { text: "Tayar basikal terlalu nipis dan mudah pancit. Tayar diganti dengan tayar tebal. Namun, basikal menjadi berat dan perlahan untuk dikayuh.", answer: "inventif" },
      { text: "Alas kasut sekolah terlalu nipis dan sakit bila berjalan jauh. Alas diganti dengan alas tebal yang empuk. Namun, kasut menjadi sempit dan kaki rasa sesak.", answer: "inventif" },
      { text: "Pisau tumpul untuk menyiang ikan. Pisau diasah menjadi tajam.", answer: "bukan" },
      { text: "Pensel tumpul untuk membuat lakaran tepat. Pensel diasah menjadi tajam.", answer: "bukan" },
      { text: "Jam dinding di kelas menunjukkan masa yang salah. Masa jam diselaraskan kepada waktu yang betul. Jam menunjukkan masa yang tepat.", answer: "bukan" },
      { text: "Lampu mentol di koridor rosak dan tidak menyala. Mentol diganti dengan mentol baru. Lampu menyala semula dengan terang.", answer: "bukan" },
      { text: "Kipas angin berdebu dan kotor. Kipas dibersihkan dengan kain. Kipas bersih dan udara lebih sejuk.", answer: "bukan" }
    ];

    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let score = 0;
    let timeLeft = 90;
    let timerInterval;
    let startTime;
    let isCombo = false;
    let correctAnswers = 0;
    let wrongAnswers = 0;
    let isDragging = false;
    let startX = 0;
    let currentX = 0;
    let comboCount = 0;
    let lastParticleTime = 0;

    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }

    function burstBubble(event) {
      const bubble = event.target;
      bubble.style.animation = 'bubble-burst 0.4s ease-out forwards';
      
      // Create mini sparkles
      const rect = bubble.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;
      
      for (let i = 0; i < 8; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'particle';
        sparkle.style.left = centerX + 'px';
        sparkle.style.top = centerY + 'px';
        sparkle.style.width = '8px';
        sparkle.style.height = '8px';
        sparkle.style.background = 'radial-gradient(circle, #ffffff, #80deea)';
        sparkle.style.boxShadow = '0 0 10px rgba(128, 222, 234, 0.8)';
        
        const angle = (Math.PI * 2 * i) / 8;
        const distance = 30 + Math.random() * 20;
        const tx = Math.cos(angle) * distance;
        const ty = Math.sin(angle) * distance;
        
        sparkle.style.setProperty('--tx', tx + 'px');
        sparkle.style.setProperty('--ty', ty + 'px');
        sparkle.style.transform = `translate(${tx}px, ${ty}px)`;
        
        document.body.appendChild(sparkle);
        
        setTimeout(() => sparkle.remove(), 800);
      }
      
      setTimeout(() => {
        bubble.style.animation = 'bubbleRise 12s infinite ease-in';
        bubble.style.opacity = '0.8';
        bubble.style.transform = 'translateY(0) translateX(0) scale(0.8)';
      }, 400);
    }

    function startGame() {
      document.getElementById('startScreen').style.display = 'none';
      document.getElementById('gameHeader').style.display = 'block';
      document.getElementById('cardArea').style.display = 'block';
      document.getElementById('swipeIndicators').style.display = 'flex';
      document.getElementById('backToMenuBtn').classList.add('show');
      
      currentQuestions = shuffleArray(questions);
      currentQuestionIndex = 0;
      score = 0;
      timeLeft = 90;
      correctAnswers = 0;
      wrongAnswers = 0;
      isCombo = false;
      comboCount = 0;
      startTime = Date.now();
      
      updateDisplay();
      loadQuestion();
      startTimer();
    }

    function backToMenu() {
      clearInterval(timerInterval);
      
      document.getElementById('gameHeader').style.display = 'none';
      document.getElementById('cardArea').style.display = 'none';
      document.getElementById('swipeIndicators').style.display = 'none';
      document.getElementById('scoreboard').classList.remove('show');
      document.getElementById('backToMenuBtn').classList.remove('show');
      hideComboIndicator();
      
      document.getElementById('startScreen').style.display = 'block';
    }

    function startTimer() {
      const circle = document.getElementById('progressCircle');
      const circumference = 150.8;
      
      timerInterval = setInterval(() => {
        timeLeft--;
        document.getElementById('timer').textContent = timeLeft;
        
        const progress = timeLeft / 90;
        const offset = circumference * (1 - progress);
        circle.style.strokeDashoffset = offset;
        
        if (timeLeft <= 20) {
          circle.setAttribute('stroke', '#f44336');
          circle.style.filter = 'drop-shadow(0 0 12px rgba(244, 67, 54, 0.8))';
        }
        
        if (timeLeft <= 0) {
          endGame();
        }
      }, 1000);
    }

    function loadQuestion() {
      if (currentQuestionIndex >= currentQuestions.length) {
        endGame();
        return;
      }
      
      const card = document.getElementById('card');
      const cardContent = document.getElementById('cardContent');
      
      cardContent.textContent = currentQuestions[currentQuestionIndex].text;
      card.style.transform = 'translateX(0) rotate(0deg)';
      card.style.opacity = '1';
      
      document.getElementById('questionCount').textContent = currentQuestionIndex + 1;
    }

    function updateDisplay() {
      document.getElementById('score').textContent = score;
      document.getElementById('timer').textContent = timeLeft;
    }

    function checkAnswer(userAnswer) {
      const correctAnswer = currentQuestions[currentQuestionIndex].answer;
      const isCorrect = userAnswer === correctAnswer;
      
      showFeedback(isCorrect);
      
      if (isCorrect) {
        correctAnswers++;
        comboCount++;
        
        let points = 5;
        // Combo bonus: if this is the 2nd correct answer in a row, add bonus
        if (comboCount >= 2) {
          points = 10;
        }
        
        score += points;
        timeLeft += 5;
        isCombo = true;
        
        showScorePopup('+' + points, true);
        showComboIndicator();
        triggerBubbles();
      } else {
        wrongAnswers++;
        score = Math.max(0, score - 2);
        isCombo = false;
        comboCount = 0;
        
        showScorePopup('-2', false);
        hideComboIndicator();
      }
      
      updateDisplay();
      currentQuestionIndex++;
      
      setTimeout(() => {
        loadQuestion();
      }, 600);
    }

    function showFeedback(isCorrect) {
      const feedback = document.getElementById('feedback');
      feedback.textContent = isCorrect ? '‚úì' : '‚úó';
      feedback.className = 'feedback ' + (isCorrect ? 'correct' : 'wrong') + ' show';
      
      setTimeout(() => {
        feedback.classList.remove('show');
      }, 1000);
    }

    function showScorePopup(text, isPositive) {
      const popup = document.getElementById('scorePopup');
      popup.textContent = text;
      popup.className = 'score-popup ' + (isPositive ? 'positive' : 'negative') + ' show';
      
      setTimeout(() => {
        popup.classList.remove('show');
      }, 1400);
    }

    function showComboIndicator() {
      const comboIndicator = document.getElementById('comboIndicator');
      comboIndicator.classList.add('show');
    }

    function hideComboIndicator() {
      const comboIndicator = document.getElementById('comboIndicator');
      comboIndicator.classList.remove('show');
    }

    function createParticleTrail(x, y, color) {
      const now = Date.now();
      if (now - lastParticleTime < 30) return;
      lastParticleTime = now;
      
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = x + 'px';
      particle.style.top = y + 'px';
      particle.style.width = (Math.random() * 8 + 4) + 'px';
      particle.style.height = particle.style.width;
      particle.style.background = color;
      particle.style.boxShadow = `0 0 15px ${color}`;
      
      document.body.appendChild(particle);
      
      setTimeout(() => particle.remove(), 800);
    }

    function triggerBubbles() {
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      
      const bubbles = [];
      const bubbleCount = 25;
      
      for (let i = 0; i < bubbleCount; i++) {
        bubbles.push({
          x: Math.random() * canvas.width,
          y: canvas.height + 20,
          size: Math.random() * 30 + 20,
          speedY: Math.random() * -3 - 2,
          speedX: Math.random() * 2 - 1,
          opacity: 0.7
        });
      }
      
      function drawBubbles() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        let activeBubbles = false;
        bubbles.forEach((b, index) => {
          if (b.y > -100) {
            activeBubbles = true;
            
            const gradient = ctx.createRadialGradient(
              b.x - b.size * 0.3, 
              b.y - b.size * 0.3, 
              0, 
              b.x, 
              b.y, 
              b.size
            );
            gradient.addColorStop(0, `rgba(255, 255, 255, ${b.opacity})`);
            gradient.addColorStop(0.5, `rgba(200, 240, 255, ${b.opacity * 0.7})`);
            gradient.addColorStop(1, `rgba(128, 222, 234, ${b.opacity * 0.3})`);
            
            ctx.beginPath();
            ctx.arc(b.x, b.y, b.size, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();
            
            ctx.strokeStyle = `rgba(255, 255, 255, ${b.opacity * 0.5})`;
            ctx.lineWidth = 2;
            ctx.stroke();
            
            b.y += b.speedY;
            b.x += b.speedX;
            b.opacity -= 0.01;
          }
        });
        
        if (activeBubbles) {
          requestAnimationFrame(drawBubbles);
        }
      }
      
      drawBubbles();
    }

    function endGame() {
      clearInterval(timerInterval);
      
      const endTime = Date.now();
      const totalTime = Math.floor((endTime - startTime) / 1000);
      const questionsAnswered = correctAnswers + wrongAnswers;
      const accuracy = questionsAnswered > 0 ? Math.round((correctAnswers / questionsAnswered) * 100) : 0;
      
      document.getElementById('gameHeader').style.display = 'none';
      document.getElementById('cardArea').style.display = 'none';
      document.getElementById('swipeIndicators').style.display = 'none';
      hideComboIndicator();
      
      document.getElementById('finalScore').textContent = score;
      document.getElementById('questionsAnswered').textContent = `Soalan Dijawab: ${questionsAnswered}/10`;
      document.getElementById('timeTaken').textContent = `Masa Diambil: ${totalTime} saat`;
      document.getElementById('accuracy').textContent = `Ketepatan: ${accuracy}%`;
      
      document.getElementById('scoreboard').classList.add('show');
      
      if (score >= 40 || accuracy >= 80) {
        launchConfetti();
      }
    }

    const card = document.getElementById('card');
    
    card.addEventListener('mousedown', startDrag);
    card.addEventListener('touchstart', startDrag, { passive: false });
    
    document.addEventListener('mousemove', drag);
    document.addEventListener('touchmove', drag, { passive: false });
    
    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);
    
    function startDrag(e) {
      if (currentQuestionIndex >= currentQuestions.length) return;
      
      isDragging = true;
      startX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
      card.style.transition = 'none';
    }
    
    function drag(e) {
      if (!isDragging) return;
      
      // Prevent default to stop scrolling and other gestures
      if (e.cancelable) {
        e.preventDefault();
      }
      e.stopPropagation();
      
      currentX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
      const currentY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
      const deltaX = currentX - startX;
      const rotation = deltaX / 20;
      
      // Create particle trail
      if (Math.abs(deltaX) > 30) {
        const color = deltaX > 0 ? 'rgba(255, 105, 180, 0.8)' : 'rgba(168, 85, 247, 0.8)';
        createParticleTrail(currentX, currentY, color);
      }
      
      if (deltaX > 50) {
        card.style.boxShadow = `0 25px 60px rgba(0, 0, 0, 0.25), 0 0 50px rgba(255, 112, 67, 0.6)`;
      } else if (deltaX < -50) {
        card.style.boxShadow = `0 25px 60px rgba(0, 0, 0, 0.25), 0 0 50px rgba(76, 175, 80, 0.6)`;
      } else {
        card.style.boxShadow = `0 25px 60px rgba(0, 0, 0, 0.25), 0 10px 30px rgba(30, 95, 122, 0.3)`;
      }
      
      card.style.transform = `translateX(${deltaX}px) rotate(${rotation}deg)`;
      card.style.opacity = 1 - Math.abs(deltaX) / 300;
    }
    
    function endDrag(e) {
      if (!isDragging) return;
      
      isDragging = false;
      const deltaX = currentX - startX;
      
      card.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
      
      if (Math.abs(deltaX) > 100) {
        const direction = deltaX > 0 ? 'right' : 'left';
        const answer = direction === 'right' ? 'inventif' : 'bukan';
        
        card.style.transform = `translateX(${direction === 'right' ? 1000 : -1000}px) rotate(${direction === 'right' ? 50 : -50}deg)`;
        card.style.opacity = '0';
        
        checkAnswer(answer);
      } else {
        card.style.transform = 'translateX(0) rotate(0deg)';
        card.style.opacity = '1';
      }
    }

    function launchConfetti() {
      const canvas = document.getElementById('confetti');
      const ctx = canvas.getContext('2d');
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      
      const particles = [];
      const bubbleCount = 40;
      const sparkleCount = 80;
      
      // Create bubbles across entire screen width
      for (let i = 0; i < bubbleCount; i++) {
        particles.push({
          type: 'bubble',
          x: (canvas.width / bubbleCount) * i + Math.random() * (canvas.width / bubbleCount),
          y: canvas.height + Math.random() * 100,
          size: Math.random() * 50 + 30,
          speedY: Math.random() * -5 - 3,
          speedX: Math.random() * 2 - 1,
          opacity: 0.8,
          wobble: Math.random() * Math.PI * 2,
          wobbleSpeed: Math.random() * 0.1 + 0.05
        });
      }
      
      // Create sparkles across entire screen width
      for (let i = 0; i < sparkleCount; i++) {
        particles.push({
          type: 'sparkle',
          x: (canvas.width / sparkleCount) * i + Math.random() * (canvas.width / sparkleCount),
          y: canvas.height + Math.random() * 300,
          size: Math.random() * 8 + 4,
          speedY: Math.random() * -7 - 4,
          speedX: Math.random() * 3 - 1.5,
          opacity: 1,
          rotation: Math.random() * Math.PI * 2,
          rotationSpeed: Math.random() * 0.3 - 0.15,
          color: ['#FFD700', '#FFA500', '#FF69B4', '#87CEEB', '#FFFFFF'][Math.floor(Math.random() * 5)]
        });
      }
      
      function drawConfetti() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        particles.forEach((p, index) => {
          if (p.type === 'bubble' && p.y > -100 && p.opacity > 0) {
            // Create radial gradient for bubble effect
            const gradient = ctx.createRadialGradient(
              p.x - p.size * 0.3, 
              p.y - p.size * 0.3, 
              0, 
              p.x, 
              p.y, 
              p.size
            );
            gradient.addColorStop(0, `rgba(255, 255, 255, ${p.opacity})`);
            gradient.addColorStop(0.3, `rgba(200, 240, 255, ${p.opacity * 0.8})`);
            gradient.addColorStop(0.7, `rgba(128, 222, 234, ${p.opacity * 0.5})`);
            gradient.addColorStop(1, `rgba(79, 179, 217, ${p.opacity * 0.2})`);
            
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            ctx.fillStyle = gradient;
            ctx.fill();
            
            // Add bubble shine
            ctx.beginPath();
            ctx.arc(p.x - p.size * 0.3, p.y - p.size * 0.3, p.size * 0.3, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(255, 255, 255, ${p.opacity * 0.6})`;
            ctx.fill();
            
            // Bubble outline
            ctx.strokeStyle = `rgba(255, 255, 255, ${p.opacity * 0.5})`;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
            ctx.stroke();
            
            p.y += p.speedY;
            p.x += p.speedX + Math.sin(p.wobble) * 2;
            p.wobble += p.wobbleSpeed;
            p.opacity -= 0.008;
            
            if (p.y < -100 || p.opacity <= 0) {
              particles.splice(index, 1);
            }
          } else if (p.type === 'sparkle' && p.y > -50 && p.opacity > 0) {
            ctx.save();
            ctx.translate(p.x, p.y);
            ctx.rotate(p.rotation);
            
            // Draw sparkle as a star
            ctx.shadowBlur = 15;
            ctx.shadowColor = p.color;
            ctx.fillStyle = p.color;
            ctx.globalAlpha = p.opacity;
            
            ctx.beginPath();
            for (let i = 0; i < 4; i++) {
              ctx.lineTo(0, -p.size);
              ctx.rotate(Math.PI / 4);
              ctx.lineTo(0, -p.size / 3);
              ctx.rotate(Math.PI / 4);
            }
            ctx.closePath();
            ctx.fill();
            
            ctx.restore();
            
            p.y += p.speedY;
            p.x += p.speedX;
            p.rotation += p.rotationSpeed;
            p.opacity -= 0.012;
            p.speedY += 0.15; // gravity
            
            if (p.y < -50 || p.opacity <= 0) {
              particles.splice(index, 1);
            }
          }
        });
        
        if (particles.length > 0) {
          requestAnimationFrame(drawConfetti);
        }
      }
      
      drawConfetti();
    }

    async function onConfigChange(config) {
      const gameTitle = config.game_title || defaultConfig.game_title;
      const timerLabel = config.timer_label || defaultConfig.timer_label;
      const scoreLabel = config.score_label || defaultConfig.score_label;
      
      document.getElementById('gameTitle').textContent = gameTitle;
      document.getElementById('headerTitle').textContent = gameTitle;
      
      const timerLabelElement = document.getElementById('timerLabel');
      timerLabelElement.textContent = '‚è±Ô∏è ' + timerLabel;
      
      const scoreLabelElement = document.getElementById('scoreLabel');
      scoreLabelElement.textContent = '‚≠ê ' + scoreLabel;
    }



    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig: defaultConfig,
        onConfigChange: onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ["game_title", config.game_title || defaultConfig.game_title],
          ["timer_label", config.timer_label || defaultConfig.timer_label],
          ["score_label", config.score_label || defaultConfig.score_label]
        ])
      });
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a4ea2a675f48066',t:'MTc2NDIxNTE1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
