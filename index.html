<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuiz Tanggungjawab Keluarga</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 20%, #f093fb 40%, #f5576c 60%, #ffa500 80%, #4facfe 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100%;
            width: 100%;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        * {
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 100%;
            min-height: 100%;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quiz-card {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea 0%, #f5576c 50%, #ffa500 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 16px;
            color: #666;
            line-height: 1.6;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #ffa500 100%);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .question-container {
            margin-bottom: 30px;
        }

        .question-number {
            font-size: 14px;
            color: #999;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 18px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            color: #333;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f3ff;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .option.correct {
            border-color: #10b981;
            background: #10b981;
            color: white;
            animation: correctPulse 0.6s ease;
        }

        .option.incorrect {
            border-color: #ef4444;
            background: #ef4444;
            color: white;
            animation: incorrectShake 0.5s ease;
        }
        
        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); box-shadow: 0 0 20px rgba(16, 185, 129, 0.6); }
        }
        
        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 10px;
            font-size: 15px;
            line-height: 1.6;
        }

        .feedback.correct {
            background: #d1fae5;
            color: #065f46;
            border: 2px solid #10b981;
        }

        .feedback.incorrect {
            background: #fee2e2;
            color: #991b1b;
            border: 2px solid #ef4444;
        }

        .button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 33%, #f093fb 66%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 16px 40px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 20px;
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
        }

        .button:active {
            transform: translateY(0);
        }

        .button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results {
            text-align: center;
        }

        .score-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #ffa500 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 30px auto;
            box-shadow: 0 10px 40px rgba(102, 126, 234, 0.4);
        }

        .score-text {
            color: white;
            font-size: 48px;
            font-weight: bold;
        }

        .result-message {
            font-size: 24px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .result-details {
            font-size: 16px;
            color: #666;
            margin-bottom: 30px;
        }

        .menu-description {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .star-counter {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            animation: starPulse 2s ease-in-out infinite;
        }
        
        @keyframes starPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .star-counter .star-icon {
            font-size: 28px;
            animation: starRotate 3s linear infinite;
        }
        
        @keyframes starRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .mascot {
            position: fixed;
            bottom: 20px;
            left: 20px;
            font-size: 80px;
            animation: mascotBounce 2s ease-in-out infinite;
            z-index: 1000;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .mascot:hover {
            transform: scale(1.1);
        }
        
        .mascot:active {
            transform: scale(0.95);
        }
        
        @keyframes mascotBounce {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }
        
        .mascot-message {
            position: fixed;
            bottom: 110px;
            left: 20px;
            background: white;
            padding: 12px 20px;
            border-radius: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            font-size: 16px;
            font-weight: 600;
            max-width: 250px;
            z-index: 1000;
            animation: messageSlide 0.5s ease;
        }
        
        @keyframes messageSlide {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            top: -10px;
            z-index: 9999;
            animation: confettiFall 3s linear;
        }
        
        @keyframes confettiFall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .family-svg {
            max-width: 150px;
            margin: 0 auto 20px;
            display: block;
        }

        @media (max-width: 768px) {
            .quiz-card {
                padding: 25px;
            }

            .title {
                font-size: 24px;
            }

            .question-text {
                font-size: 18px;
            }

            .option {
                padding: 15px;
                font-size: 15px;
            }

            .button {
                padding: 14px 30px;
                font-size: 16px;
            }

            .score-circle {
                width: 150px;
                height: 150px;
            }

            .score-text {
                font-size: 36px;
            }

            .result-message {
                font-size: 20px;
            }
            
            .star-counter {
                top: 10px;
                right: 10px;
                padding: 10px 20px;
                font-size: 20px;
            }
            
            .mascot {
                font-size: 60px;
                bottom: 10px;
                left: 10px;
            }
            
            .mascot-message {
                bottom: 80px;
                left: 10px;
                font-size: 14px;
                max-width: 200px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            .quiz-card {
                padding: 20px;
            }

            .title {
                font-size: 20px;
            }

            .subtitle {
                font-size: 14px;
            }

            .question-text {
                font-size: 16px;
            }

            .option {
                padding: 12px;
                font-size: 14px;
            }
            
            .star-counter {
                padding: 8px 15px;
                font-size: 18px;
            }
            
            .star-counter .star-icon {
                font-size: 22px;
            }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="star-counter" id="starCounter"><span class="star-icon">‚≠ê</span> <span id="starCount">0</span>
  </div>
  <div class="mascot" id="mascot" onclick="onMascotClick()">
   üë®‚Äçüë©‚Äçüëß‚Äçüë¶
  </div>
  <div class="mascot-message" id="mascotMessage" style="display: none;"></div>
  <div class="container">
   <div class="quiz-card" id="quizCard"><!-- Content will be dynamically inserted here -->
   </div>
  </div>
  <div id="confettiContainer"></div>
  <script>
        const defaultConfig = {
            quiz_title: "Tanggungjawab Diri Membentuk Keluarga Bahagia",
            menu_description: "Kuiz interaktif ini membantu pelajar Tingkatan 2 mengulang kaji nota tentang tanggungjawab dalam keluarga. Anda akan menjawab 10 soalan rawak daripada 15 soalan yang disediakan.",
            start_button: "Mula Kuiz",
            next_button: "Soalan Seterusnya",
            restart_button: "Cuba Lagi"
        };

        const allQuestions = [
            {
                question: "Apakah yang perlu dilakukan oleh setiap anggota keluarga untuk melahirkan keluarga bahagia?",
                options: ["Melaksanakan tanggungjawab masing-masing", "Tercetus perselisihan faham antara anggota keluarga", "Keluarga bahagia dapat diwujudkan", "Membantu ibu bapa di rumah"],
                correct: 0
            },
            {
                question: "Antara berikut, yang manakah BUKAN tanggungjawab sebagai anggota keluarga?",
                options: ["Menyayangi setiap anggota keluarga", "Menjaga nama baik keluarga", "Masyarakat memandang rendah kepada anggota keluarga", "Menghormati anggota keluarga yang lebih tua"],
                correct: 2
            },
            {
                question: "Apakah kesan jika tanggungjawab dalam keluarga diabaikan?",
                options: ["Anggota keluarga saling mempercayai", "Tercetus perselisihan faham antara anggota keluarga", "Membantu ibu bapa di rumah", "Menjaga nama baik keluarga"],
                correct: 1
            },
            {
                question: "Bagaimanakah cara untuk menjaga kebajikan anggota keluarga?",
                options: ["Membantu ibu bapa di rumah", "Kebahagiaan keluarga terjejas", "Menjaga kebajikan anggota keluarga", "Nama baik keluarga terjejas"],
                correct: 0
            },
            {
                question: "Apakah kepentingan melaksanakan tanggungjawab diri dalam keluarga?",
                options: ["Menjaga nama baik keluarga", "Anggota keluarga saling mempercayai", "Tercetus perselisihan faham", "Membantu adik-beradik dalam pelajaran"],
                correct: 1
            },
            {
                question: "Antara berikut, yang manakah cara menghormati anggota keluarga?",
                options: ["Menghindari aktiviti negatif", "Mendengar nasihat anggota keluarga", "Keluarga dihormati oleh masyarakat sekeliling", "Menjaga kebajikan anggota keluarga"],
                correct: 1
            },
            {
                question: "Bagaimanakah cara memastikan keselamatan anggota keluarga?",
                options: ["Memastikan keselamatan anggota keluarga", "Menutup suis peralatan elektrik jika tidak menggunakannya", "Maruah keluarga terpelihara", "Menjaga nama baik keluarga"],
                correct: 1
            },
            {
                question: "Apakah cara menjaga nama baik keluarga?",
                options: ["Keluarga dihormati oleh masyarakat sekeliling", "Nama baik keluarga terjejas", "Berusaha dengan bersungguh-sungguh dalam pelajaran", "Menghormati anggota keluarga"],
                correct: 2
            },
            {
                question: "Bagaimanakah cara menyayangi anggota keluarga termasuk yang kurang upaya?",
                options: ["Menyayangi setiap anggota keluarga", "Membantu anggota keluarga termasuk yang kurang upaya", "Menjaga keselamatan adik-beradik", "Kebahagiaan keluarga terjejas"],
                correct: 1
            },
            {
                question: "Apakah kesan apabila kebahagiaan keluarga terjejas?",
                options: ["Keluarga bahagia dapat diwujudkan", "Hubungan anggota keluarga menjadi renggang", "Menjaga kebajikan anggota keluarga", "Melibatkan diri dalam aktiviti keluarga"],
                correct: 1
            },
            {
                question: "Antara berikut, yang manakah tanggungjawab sebagai anggota keluarga?",
                options: ["Membantu adik-beradik dalam pelajaran", "Tercetus perselisihan faham", "Anggota keluarga saling mempercayai", "Maruah keluarga terpelihara"],
                correct: 0
            },
            {
                question: "Mengapakah penting untuk menghindari aktiviti negatif?",
                options: ["Menghindari aktiviti negatif", "Untuk menjaga nama baik keluarga", "Keluarga dihormati oleh masyarakat sekeliling", "Menuturkan kata-kata sopan"],
                correct: 1
            },
            {
                question: "Apakah yang dimaksudkan dengan cara menghormati anggota keluarga melalui komunikasi?",
                options: ["Menghormati anggota keluarga yang lebih tua", "Saling bertegur sapa", "Masyarakat memandang rendah", "Nama baik keluarga terjejas"],
                correct: 1
            },
            {
                question: "Bagaimanakah cara memastikan keselamatan adik-beradik ketika orang dewasa tiada di rumah?",
                options: ["Memastikan keselamatan anggota keluarga", "Menjaga adik-beradik ketika orang dewasa tiada di rumah", "Keluarga bahagia dapat diwujudkan", "Melibatkan diri dalam aktiviti keluarga"],
                correct: 1
            },
            {
                question: "Apakah kepentingan melaksanakan tanggungjawab yang membawa kepada penghormatan masyarakat?",
                options: ["Tercetus perselisihan faham", "Maruah keluarga terpelihara", "Menjaga kebajikan anggota keluarga", "Menghindari aktiviti negatif"],
                correct: 1
            }
        ];

        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let answered = false;
        let totalStars = 0;
        
        const mascotMessages = {
            start: ["Mari kita mula! üí™", "Anda pasti boleh buat! üåü", "Semangat! üéâ"],
            correct: ["Hebat! Teruskan! üéä", "Bagus sekali! ‚≠ê", "Cemerlang! üåü", "Mantap! üëè"],
            incorrect: ["Tak mengapa, cuba lagi! üí™", "Jangan putus asa! üåà", "Belajar dari kesilapan! üìö"],
            finish: ["Tahniah selesai! üéâ", "Kerja yang bagus! üåü", "Anda hebat! üëè"],
            click: [
                "Ingat! Keluarga bahagia bermula dengan tanggungjawab! üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
                "Sentiasa sayangi setiap ahli keluarga anda! ‚ù§Ô∏è",
                "Jaga nama baik keluarga dengan elakkan aktiviti negatif! üåü",
                "Hormati ahli keluarga yang lebih tua! üôè",
                "Bantu ibu bapa di rumah setiap hari! üè†",
                "Jaga keselamatan adik-beradik anda! üõ°Ô∏è",
                "Komunikasi yang baik penting dalam keluarga! üí¨",
                "Belajar bersungguh-sungguh untuk keluarga! üìö",
                "Anda boleh buat! Teruskan berusaha! üí™",
                "Keluarga adalah harta yang paling berharga! üíé",
                "Melaksanakan tanggungjawab = Keluarga bahagia! üòä",
                "Kebajikan keluarga adalah tanggungjawab bersama! ü§ù",
                "Kepercayaan ahli keluarga dibina melalui tanggungjawab! ‚ú®",
                "Setiap ahli keluarga punya peranan penting! üéØ",
                "Mari wujudkan keluarga yang harmoni! üåà"
            ]
        };
        
        let mascotMessageTimeout;
        
        function showMascotMessage(type) {
            const messages = mascotMessages[type];
            const message = messages[Math.floor(Math.random() * messages.length)];
            const mascotMsg = document.getElementById('mascotMessage');
            
            // Clear previous timeout
            if (mascotMessageTimeout) {
                clearTimeout(mascotMessageTimeout);
            }
            
            mascotMsg.textContent = message;
            mascotMsg.style.display = 'block';
            
            mascotMessageTimeout = setTimeout(() => {
                mascotMsg.style.display = 'none';
            }, 4000);
        }
        
        function onMascotClick() {
            const mascot = document.getElementById('mascot');
            
            // Add bounce animation
            mascot.style.animation = 'none';
            setTimeout(() => {
                mascot.style.animation = 'mascotBounce 2s ease-in-out infinite';
            }, 10);
            
            // Show random message or reminder
            showMascotMessage('click');
        }
        
        function updateStarCount() {
            document.getElementById('starCount').textContent = totalStars;
        }
        
        function createConfetti() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#6c5ce7', '#a29bfe', '#fd79a8', '#fdcb6e'];
            const confettiContainer = document.getElementById('confettiContainer');
            
            for (let i = 0; i < 100; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    confettiContainer.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3000);
                }, i * 30);
            }
        }

        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        function selectRandomQuestions() {
            const shuffled = shuffleArray(allQuestions);
            currentQuestions = shuffled.slice(0, 10).map(q => ({
                ...q,
                options: shuffleArray([...q.options]),
                correctAnswer: q.options[q.correct]
            }));
        }

        function showMenu() {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const quizCard = document.getElementById('quizCard');
            quizCard.innerHTML = `
                <div class="header">
                    <svg class="family-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
                        <!-- Dad -->
                        <circle cx="60" cy="70" r="15" fill="#FFD93D"/>
                        <rect x="50" y="85" width="20" height="30" rx="5" fill="#6BCB77"/>
                        <!-- Mom -->
                        <circle cx="100" cy="70" r="15" fill="#FFD93D"/>
                        <rect x="90" y="85" width="20" height="30" rx="5" fill="#FF6B9D"/>
                        <!-- Kid 1 -->
                        <circle cx="75" cy="100" r="12" fill="#FFD93D"/>
                        <rect x="67" y="112" width="16" height="25" rx="4" fill="#4D96FF"/>
                        <!-- Kid 2 -->
                        <circle cx="115" cy="100" r="12" fill="#FFD93D"/>
                        <rect x="107" y="112" width="16" height="25" rx="4" fill="#C77DFF"/>
                        <!-- Hearts -->
                        <text x="85" y="55" font-size="16" fill="#FF6B9D">‚ù§Ô∏è</text>
                        <text x="130" y="90" font-size="12" fill="#FF6B9D">üíï</text>
                    </svg>
                    <h1 class="title">${config.quiz_title || defaultConfig.quiz_title}</h1>
                </div>
                <div class="menu-description">
                    <p class="subtitle">${config.menu_description || defaultConfig.menu_description}</p>
                </div>
                <button class="button" onclick="startQuiz()">${config.start_button || defaultConfig.start_button}</button>
            `;
        }

        function startQuiz() {
            selectRandomQuestions();
            currentQuestionIndex = 0;
            score = 0;
            totalStars = 0;
            answered = false;
            updateStarCount();
            showMascotMessage('start');
            showQuestion();
        }

        function showQuestion() {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const question = currentQuestions[currentQuestionIndex];
            const progress = ((currentQuestionIndex) / currentQuestions.length) * 100;
            
            const quizCard = document.getElementById('quizCard');
            quizCard.innerHTML = `
                <div class="header">
                    <h1 class="title">${config.quiz_title || defaultConfig.quiz_title}</h1>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%"></div>
                </div>
                <div class="question-container">
                    <div class="question-number">Soalan ${currentQuestionIndex + 1} daripada ${currentQuestions.length}</div>
                    <div class="question-text">${question.question}</div>
                    <div class="options" id="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectAnswer(${index})" data-index="${index}">
                                ${option}
                            </div>
                        `).join('')}
                    </div>
                    <div id="feedback"></div>
                </div>
                <button class="button" id="nextBtn" onclick="nextQuestion()" style="display: none;">${config.next_button || defaultConfig.next_button}</button>
            `;
            answered = false;
        }

        function selectAnswer(index) {
            if (answered) return;
            
            answered = true;
            const question = currentQuestions[currentQuestionIndex];
            const selectedOption = question.options[index];
            const isCorrect = selectedOption === question.correctAnswer;
            
            if (isCorrect) {
                score++;
                totalStars++;
                updateStarCount();
                showMascotMessage('correct');
            } else {
                showMascotMessage('incorrect');
            }
            
            const options = document.querySelectorAll('.option');
            options.forEach((option, i) => {
                option.classList.add('disabled');
                if (question.options[i] === question.correctAnswer) {
                    option.classList.add('correct');
                } else if (i === index && !isCorrect) {
                    option.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('feedback');
            if (isCorrect) {
                feedback.innerHTML = '<div class="feedback correct">‚úì Tahniah! Jawapan anda betul. +1 ‚≠ê</div>';
            } else {
                feedback.innerHTML = `<div class="feedback incorrect">‚úó Maaf, jawapan yang betul ialah: ${question.correctAnswer}</div>`;
            }
            
            document.getElementById('nextBtn').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuestions.length) {
                showQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            const config = window.elementSdk ? window.elementSdk.config : defaultConfig;
            const percentage = (score / currentQuestions.length) * 100;
            let message = "";
            let icon = "";
            
            if (percentage === 100) {
                message = "Cemerlang! Full Marks!";
                icon = "üèÜ";
                createConfetti();
                showMascotMessage('finish');
            } else if (percentage >= 80) {
                message = "Cemerlang!";
                icon = "üåü";
            } else if (percentage >= 60) {
                message = "Bagus!";
                icon = "ÔøΩÔøΩ";
            } else if (percentage >= 40) {
                message = "Boleh diperbaiki!";
                icon = "üìö";
            } else {
                message = "Teruskan berusaha!";
                icon = "üí™";
            }
            
            const quizCard = document.getElementById('quizCard');
            quizCard.innerHTML = `
                <div class="header">
                    <h1 class="title">${config.quiz_title || defaultConfig.quiz_title}</h1>
                </div>
                <div class="results">
                    <div class="icon">${icon}</div>
                    <div class="result-message">${message}</div>
                    <div class="score-circle">
                        <div class="score-text">${score}/${currentQuestions.length}</div>
                    </div>
                    <div class="result-details">
                        Anda telah menjawab ${score} soalan dengan betul daripada ${currentQuestions.length} soalan.
                        <br>Peratusan: ${percentage.toFixed(0)}%
                        <br><br>‚≠ê Jumlah Bintang Dikumpul: ${totalStars}
                    </div>
                    <button class="button" onclick="startQuiz()">${config.restart_button || defaultConfig.restart_button}</button>
                </div>
            `;
        }

        async function onConfigChange(config) {
            const titleElements = document.querySelectorAll('.title');
            titleElements.forEach(el => {
                el.textContent = config.quiz_title || defaultConfig.quiz_title;
            });

            const menuDesc = document.querySelector('.menu-description .subtitle');
            if (menuDesc) {
                menuDesc.textContent = config.menu_description || defaultConfig.menu_description;
            }

            const startBtn = document.querySelector('.button[onclick="startQuiz()"]');
            if (startBtn && !document.getElementById('nextBtn')) {
                startBtn.textContent = config.start_button || defaultConfig.start_button;
            }

            const nextBtn = document.getElementById('nextBtn');
            if (nextBtn) {
                nextBtn.textContent = config.next_button || defaultConfig.next_button;
            }

            const restartBtn = document.querySelector('.results .button');
            if (restartBtn) {
                restartBtn.textContent = config.restart_button || defaultConfig.restart_button;
            }
        }

        if (window.elementSdk) {
            window.elementSdk.init({
                defaultConfig: defaultConfig,
                onConfigChange: onConfigChange,
                mapToCapabilities: (config) => ({
                    recolorables: [],
                    borderables: [],
                    fontEditable: undefined,
                    fontSizeable: undefined
                }),
                mapToEditPanelValues: (config) => new Map([
                    ["quiz_title", config.quiz_title || defaultConfig.quiz_title],
                    ["menu_description", config.menu_description || defaultConfig.menu_description],
                    ["start_button", config.start_button || defaultConfig.start_button],
                    ["next_button", config.next_button || defaultConfig.next_button],
                    ["restart_button", config.restart_button || defaultConfig.restart_button]
                ])
            });
        }

        showMenu();
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a71c28032c01d95',t:'MTc2NDU4MzQ2MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
