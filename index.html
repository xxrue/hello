<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Operasi Set: Persilangan Set</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800;900&display=swap');
    
    body {
      box-sizing: border-box;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100%;
      width: 100%;
    }
    
    .main-wrapper {
      width: 100%;
      min-height: 100%;
      padding: 40px 20px;
    }
    
    .content-container {
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 30px;
      align-items: start;
    }
    
    .left-panel {
      background: white;
      border-radius: 24px;
      padding: 36px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
      position: sticky;
      top: 20px;
    }
    
    header {
      margin-bottom: 32px;
      padding-bottom: 24px;
      border-bottom: 4px solid #667eea;
    }
    
    h1 {
      color: #1a202c;
      font-size: 32px;
      margin: 0 0 12px 0;
      font-weight: 900;
      line-height: 1.2;
      letter-spacing: -0.5px;
    }
    
    .instruction {
      color: #4a5568;
      font-size: 15px;
      margin: 0;
      line-height: 1.6;
      font-weight: 500;
    }
    
    .legend {
      margin-bottom: 32px;
      padding: 24px;
      background: linear-gradient(135deg, #f7fafc, #edf2f7);
      border-radius: 16px;
      border: 2px solid #e2e8f0;
    }
    
    .legend h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      color: #2d3748;
      font-weight: 800;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .legend-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin: 10px 0;
      font-size: 15px;
      color: #2d3748;
      font-weight: 600;
    }
    
    .legend-symbol {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 8px;
      font-weight: 800;
      font-size: 18px;
      color: #667eea;
      box-shadow: 0 4px 8px rgba(102, 126, 234, 0.2);
    }
    
    .legend-divider {
      margin: 16px 0;
      padding-top: 16px;
      border-top: 2px solid #cbd5e0;
    }
    
    .expression-section {
      margin-bottom: 32px;
    }
    
    .expression-label {
      font-size: 14px;
      font-weight: 800;
      color: #2d3748;
      margin-bottom: 16px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .expression-builder {
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      padding: 20px;
      background: #f7fafc;
      border-radius: 16px;
      border: 3px solid #e2e8f0;
    }
    
    select {
      padding: 12px 16px;
      border: 3px solid #cbd5e1;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
      min-width: 75px;
      color: #1a202c;
    }
    
    select:hover {
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(102, 126, 234, 0.3);
    }
    
    select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
    }
    
    .button-group {
      display: flex;
      flex-direction: column;
      gap: 14px;
    }
    
    button {
      width: 100%;
      padding: 18px 28px;
      font-size: 16px;
      font-weight: 800;
      font-family: 'Poppins', sans-serif;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-transform: uppercase;
      letter-spacing: 1.2px;
    }
    
    .btn-show {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
    }
    
    .btn-show:hover {
      background: linear-gradient(135deg, #5568d3 0%, #6a3f8f 100%);
      transform: translateY(-3px);
      box-shadow: 0 10px 24px rgba(102, 126, 234, 0.5);
    }
    
    .btn-show:active {
      transform: translateY(0);
    }
    
    .btn-reset {
      background: #edf2f7;
      color: #4a5568;
      border: 3px solid #cbd5e1;
    }
    
    .btn-reset:hover {
      background: #e2e8f0;
      border-color: #a0aec0;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
    }
    
    .venn-container {
      background: white;
      border-radius: 24px;
      padding: 60px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.25);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 650px;
    }
    
    svg {
      max-width: 100%;
      height: auto;
    }
    
    .set-circle {
      fill: none;
      stroke-width: 4;
      transition: all 0.5s ease;
    }
    
    .set-label {
      font-size: 32px;
      font-weight: 900;
      font-family: 'Poppins', sans-serif;
    }
    
    .region {
      transition: all 0.5s ease;
      opacity: 0;
    }
    
    .region.active {
      opacity: 0.75;
    }
    
    @media (max-width: 1200px) {
      .content-container {
        grid-template-columns: 1fr;
      }
      
      .left-panel {
        position: relative;
        top: 0;
      }
    }
    
    @media (max-width: 768px) {
      .main-wrapper {
        padding: 20px 16px;
      }
      
      h1 {
        font-size: 26px;
      }
      
      .instruction {
        font-size: 14px;
      }
      
      .left-panel {
        padding: 28px;
      }
      
      .venn-container {
        padding: 32px;
        min-height: 450px;
      }
      
      .expression-builder {
        gap: 8px;
      }
      
      select {
        min-width: 65px;
        font-size: 16px;
        padding: 10px 12px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <main class="main-wrapper">
   <div class="content-container">
    <aside class="left-panel">
     <header>
      <h1 id="main-title">Operasi Set: Persilangan Set</h1>
      <p class="instruction" id="instruction-text">Pilih operasi untuk setiap set dan klik 'Tunjukkan Hasil' untuk melihat persilangan</p>
     </header>
     <div class="legend">
      <h3>Set Semesta (ξ)</h3>
      <div class="legend-item"><span class="legend-symbol" style="color: #e53e3e;">A</span> <span>Set A</span>
      </div>
      <div class="legend-item"><span class="legend-symbol" style="color: #38b2ac;">B</span> <span>Set B</span>
      </div>
      <div class="legend-item"><span class="legend-symbol" style="color: #dd6b20;">C</span> <span>Set C</span>
      </div>
      <div class="legend-divider">
       <div class="legend-item"><span class="legend-symbol">∩</span> <span>Persilangan</span>
       </div>
       <div class="legend-item"><span class="legend-symbol">∪</span> <span>Kesatuan</span>
       </div>
      </div>
     </div>
     <div class="expression-section">
      <div class="expression-label">
       Bina Ekspresi Set
      </div>
      <div class="expression-builder"><select id="setA" aria-label="Pilih Set A atau pelengkap A"> <option value="A">A</option> <option value="A'">A'</option> </select> <select id="operator1" aria-label="Pilih operasi pertama"> <option value="∩">∩</option> <option value="∪">∪</option> </select> <select id="setB" aria-label="Pilih Set B atau pelengkap B"> <option value="B">B</option> <option value="B'">B'</option> </select> <select id="operator2" aria-label="Pilih operasi kedua"> <option value="∩">∩</option> <option value="∪">∪</option> </select> <select id="setC" aria-label="Pilih Set C atau pelengkap C"> <option value="C">C</option> <option value="C'">C'</option> </select>
      </div>
     </div>
     <div class="button-group"><button class="btn-show" id="showBtn">Tunjukkan Hasil</button> <button class="btn-reset" id="resetBtn">Set Semula</button>
     </div>
    </aside>
    <div class="venn-container">
     <canvas id="vennCanvas" width="700" height="550" style="max-width: 100%; height: auto;"></canvas>
    </div>
   </div>
  </main>
  <script>
    const defaultConfig = {
      main_title: "Operasi Set: Persilangan Set",
      instruction_text: "Pilih operasi untuk setiap set dan klik 'Tunjukkan Hasil' untuk melihat persilangan",
      show_button: "Tunjukkan Hasil",
      reset_button: "Set Semula"
    };

    async function onConfigChange(config) {
      const titleElement = document.getElementById('main-title');
      const instructionElement = document.getElementById('instruction-text');
      const showBtnElement = document.getElementById('showBtn');
      const resetBtnElement = document.getElementById('resetBtn');
      
      if (titleElement) {
        titleElement.textContent = config.main_title || defaultConfig.main_title;
      }
      if (instructionElement) {
        instructionElement.textContent = config.instruction_text || defaultConfig.instruction_text;
      }
      if (showBtnElement) {
        showBtnElement.textContent = config.show_button || defaultConfig.show_button;
      }
      if (resetBtnElement) {
        resetBtnElement.textContent = config.reset_button || defaultConfig.reset_button;
      }
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["main_title", config.main_title || defaultConfig.main_title],
        ["instruction_text", config.instruction_text || defaultConfig.instruction_text],
        ["show_button", config.show_button || defaultConfig.show_button],
        ["reset_button", config.reset_button || defaultConfig.reset_button]
      ]);
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }

    // Venn diagram logic
    const canvas = document.getElementById('vennCanvas');
    const ctx = canvas.getContext('2d');
    const setASelect = document.getElementById('setA');
    const setBSelect = document.getElementById('setB');
    const setCSelect = document.getElementById('setC');
    const operator1Select = document.getElementById('operator1');
    const operator2Select = document.getElementById('operator2');
    const showBtn = document.getElementById('showBtn');
    const resetBtn = document.getElementById('resetBtn');

    // Circle positions and radius
    const circles = {
      A: { x: 280, y: 220, r: 120, color: '#e53e3e' },
      B: { x: 420, y: 220, r: 120, color: '#38b2ac' },
      C: { x: 350, y: 340, r: 120, color: '#dd6b20' }
    };

    // Check if a point is inside a circle
    function isInCircle(px, py, circle) {
      const dx = px - circle.x;
      const dy = py - circle.y;
      return (dx * dx + dy * dy) <= (circle.r * circle.r);
    }

    // Determine which region a point belongs to
    function getRegion(x, y) {
      const inA = isInCircle(x, y, circles.A);
      const inB = isInCircle(x, y, circles.B);
      const inC = isInCircle(x, y, circles.C);

      if (inA && inB && inC) return 'ABC';
      if (inA && inB && !inC) return 'AB';
      if (inA && !inB && inC) return 'AC';
      if (!inA && inB && inC) return 'BC';
      if (inA && !inB && !inC) return 'A';
      if (!inA && inB && !inC) return 'B';
      if (!inA && !inB && inC) return 'C';
      return 'outside';
    }

    // Draw the Venn diagram
    function drawVenn(highlightRegions = []) {
      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw universal set boundary
      ctx.strokeStyle = '#a0aec0';
      ctx.lineWidth = 3;
      ctx.setLineDash([8, 5]);
      ctx.strokeRect(60, 60, 580, 430);
      ctx.setLineDash([]);

      // Define region colors
      const regionColors = {
        'A': '#fc8181',
        'B': '#4fd1c5',
        'C': '#f6ad55',
        'AB': '#d6bcfa',
        'AC': '#feb2b2',
        'BC': '#9ae6b4',
        'ABC': '#9f7aea',
        'outside': '#cbd5e0'
      };

      // Draw highlighted regions using pixel-by-pixel approach
      if (highlightRegions.length > 0) {
        const imageData = ctx.createImageData(canvas.width, canvas.height);
        const data = imageData.data;

        for (let y = 0; y < canvas.height; y++) {
          for (let x = 0; x < canvas.width; x++) {
            const region = getRegion(x, y);
            const idx = (y * canvas.width + x) * 4;

            if (highlightRegions.includes(region)) {
              const color = regionColors[region];
              const rgb = hexToRgb(color);
              data[idx] = rgb.r;
              data[idx + 1] = rgb.g;
              data[idx + 2] = rgb.b;
              data[idx + 3] = 190; // Alpha (75% opacity)
            }
          }
        }

        ctx.putImageData(imageData, 0, 0);
      }

      // Draw circles
      Object.keys(circles).forEach(key => {
        const circle = circles[key];
        ctx.beginPath();
        ctx.arc(circle.x, circle.y, circle.r, 0, Math.PI * 2);
        ctx.strokeStyle = circle.color;
        ctx.lineWidth = 4;
        ctx.stroke();
      });

      // Draw labels
      ctx.font = '900 32px Poppins, sans-serif';
      ctx.fillStyle = circles.A.color;
      ctx.fillText('A', 200, 150);
      ctx.fillStyle = circles.B.color;
      ctx.fillText('B', 480, 150);
      ctx.fillStyle = circles.C.color;
      ctx.fillText('C', 330, 450);

      // Draw universal set label
      ctx.font = '800 24px Poppins, sans-serif';
      ctx.fillStyle = '#718096';
      ctx.fillText('ξ', 605, 85);
    }

    // Convert hex to RGB
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
      } : { r: 0, g: 0, b: 0 };
    }

    // Map sets to regions
    const regionMap = {
      'A': ['A', 'AB', 'AC', 'ABC'],
      'B': ['B', 'AB', 'BC', 'ABC'],
      'C': ['C', 'AC', 'BC', 'ABC'],
      "A'": ['B', 'C', 'BC', 'outside'],
      "B'": ['A', 'C', 'AC', 'outside'],
      "C'": ['A', 'B', 'AB', 'outside']
    };

    function intersect(arr1, arr2) {
      return arr1.filter(x => arr2.includes(x));
    }

    function union(arr1, arr2) {
      return [...new Set([...arr1, ...arr2])];
    }

    showBtn.addEventListener('click', () => {
      const setA = setASelect.value;
      const setB = setBSelect.value;
      const setC = setCSelect.value;
      const op1 = operator1Select.value;
      const op2 = operator2Select.value;

      // Get regions for each set
      let regionsA = regionMap[setA];
      let regionsB = regionMap[setB];
      let regionsC = regionMap[setC];

      // Apply first operation (A op1 B)
      let result = op1 === '∩' ? intersect(regionsA, regionsB) : union(regionsA, regionsB);

      // Apply second operation (result op2 C)
      result = op2 === '∩' ? intersect(result, regionsC) : union(result, regionsC);

      drawVenn(result);
    });

    resetBtn.addEventListener('click', () => {
      setASelect.value = 'A';
      setBSelect.value = 'B';
      setCSelect.value = 'C';
      operator1Select.value = '∩';
      operator2Select.value = '∩';
      drawVenn([]);
    });

    // Initial draw
    drawVenn([]);
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9aa863b82568454a',t:'MTc2NTE1NjI5NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
