<!doctype html>
<html lang="ms">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kuiz Bola Tampar</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100%;
      padding: 20px;
      box-sizing: border-box;
      transition: background 0.8s ease;
    }

    body.dark-mode {
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
    }

    html {
      height: 100%;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .volleyball-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: 0;
      pointer-events: none;
    }

    .falling-volleyball {
      position: absolute;
      font-size: 30px;
      opacity: 0.3;
      animation: fall linear infinite;
    }

    @keyframes fall {
      0% {
        transform: translateY(-100px) rotate(0deg);
      }
      100% {
        transform: translateY(100vh) rotate(360deg);
      }
    }

    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      top: -10px;
      z-index: 9999;
      animation: confettiFall 3s ease-out forwards;
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 30px;
      animation: slideDown 0.6s ease-out;
      transition: all 0.8s ease;
    }

    .header h1 {
      font-size: 48px;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .header p {
      font-size: 20px;
      opacity: 0.95;
    }

    body.dark-mode .header h1 {
      color: #f093fb;
      text-shadow: 0 0 20px rgba(240, 147, 251, 0.5);
    }

    body.dark-mode .header p {
      color: #e0e0e0;
    }

    .volleyball-icon {
      font-size: 50px;
      animation: bounce 2s infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .quiz-card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      margin-bottom: 20px;
      animation: fadeIn 0.6s ease-out;
      transition: all 0.8s ease;
    }

    body.dark-mode .quiz-card {
      background: #0f3460;
      box-shadow: 0 10px 40px rgba(240, 147, 251, 0.3);
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: scale(0.95);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 10px;
    }

    .question-number {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 14px;
      transition: all 0.8s ease;
    }

    body.dark-mode .question-number {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .score {
      color: #667eea;
      font-weight: bold;
      font-size: 18px;
      transition: all 0.8s ease;
    }

    body.dark-mode .score {
      color: #f093fb;
    }

    .question-text {
      font-size: 20px;
      color: #2d3748;
      margin-bottom: 25px;
      line-height: 1.6;
      font-weight: 500;
      transition: all 0.8s ease;
    }

    body.dark-mode .question-text {
      color: #e0e0e0;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option {
      background: #f7fafc;
      border: 3px solid #e2e8f0;
      border-radius: 12px;
      padding: 18px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 16px;
      color: #2d3748;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    body.dark-mode .option {
      background: #1a1a2e;
      border-color: #2a2a4e;
      color: #e0e0e0;
    }

    .option:hover:not(.disabled) {
      background: #edf2f7;
      border-color: #667eea;
      transform: translateX(5px);
    }

    body.dark-mode .option:hover:not(.disabled) {
      background: #2a2a4e;
      border-color: #f093fb;
    }

    .option.selected {
      background: #667eea;
      border-color: #667eea;
      color: white;
      font-weight: 600;
    }

    body.dark-mode .option.selected {
      background: #f093fb;
      border-color: #f093fb;
    }

    .option.correct {
      background: #48bb78;
      border-color: #48bb78;
      color: white;
      animation: correctPulse 0.5s ease;
    }

    .option.wrong {
      background: #f56565;
      border-color: #f56565;
      color: white;
      animation: shake 0.5s ease;
    }

    .option.disabled {
      cursor: not-allowed;
      opacity: 0.6;
    }

    @keyframes correctPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    body.dark-mode .option.correct {
      animation: redemptionCorrect 0.8s ease;
      box-shadow: 0 0 30px rgba(72, 187, 120, 0.8);
    }

    body.dark-mode .option.wrong {
      animation: redemptionWrong 0.8s ease;
      box-shadow: 0 0 30px rgba(245, 101, 101, 0.8);
    }

    @keyframes redemptionCorrect {
      0% { transform: scale(1); box-shadow: 0 0 0 rgba(72, 187, 120, 0); }
      25% { transform: scale(1.05); box-shadow: 0 0 40px rgba(72, 187, 120, 1); }
      50% { transform: scale(0.98); box-shadow: 0 0 50px rgba(72, 187, 120, 0.8); }
      75% { transform: scale(1.02); box-shadow: 0 0 40px rgba(72, 187, 120, 1); }
      100% { transform: scale(1); box-shadow: 0 0 30px rgba(72, 187, 120, 0.8); }
    }

    @keyframes redemptionWrong {
      0%, 100% { transform: translateX(0); box-shadow: 0 0 30px rgba(245, 101, 101, 0.8); }
      10% { transform: translateX(-10px) rotate(-2deg); box-shadow: 0 0 40px rgba(245, 101, 101, 1); }
      20% { transform: translateX(10px) rotate(2deg); box-shadow: 0 0 50px rgba(245, 101, 101, 0.8); }
      30% { transform: translateX(-10px) rotate(-2deg); box-shadow: 0 0 40px rgba(245, 101, 101, 1); }
      40% { transform: translateX(10px) rotate(2deg); box-shadow: 0 0 50px rgba(245, 101, 101, 0.8); }
      50% { transform: translateX(-5px) rotate(-1deg); box-shadow: 0 0 40px rgba(245, 101, 101, 1); }
      60% { transform: translateX(5px) rotate(1deg); box-shadow: 0 0 35px rgba(245, 101, 101, 0.8); }
    }

    .option-letter {
      background: white;
      color: #667eea;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      flex-shrink: 0;
      transition: all 0.3s ease;
    }

    body.dark-mode .option-letter {
      background: #0f3460;
      color: #f093fb;
    }

    .option.selected .option-letter,
    .option.correct .option-letter,
    .option.wrong .option-letter {
      background: rgba(255,255,255,0.3);
      color: white;
    }

    .next-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      border-radius: 25px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      width: 100%;
      margin-top: 20px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }

    body.dark-mode .next-button {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      box-shadow: 0 4px 15px rgba(240, 147, 251, 0.4);
    }

    .next-button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.5);
    }

    body.dark-mode .next-button:hover:not(:disabled) {
      box-shadow: 0 6px 20px rgba(240, 147, 251, 0.5);
    }

    .next-button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .result-card {
      text-align: center;
      padding: 40px 30px;
    }

    .result-icon {
      font-size: 80px;
      margin-bottom: 20px;
      animation: scaleIn 0.6s ease-out;
    }

    @keyframes scaleIn {
      from {
        transform: scale(0);
      }
      to {
        transform: scale(1);
      }
    }

    .result-title {
      font-size: 32px;
      color: #2d3748;
      margin-bottom: 15px;
      font-weight: bold;
    }

    .result-score {
      font-size: 24px;
      color: #667eea;
      margin-bottom: 20px;
    }

    .result-message {
      font-size: 18px;
      color: #4a5568;
      margin-bottom: 30px;
      line-height: 1.6;
    }

    .restart-button {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: white;
      border: none;
      padding: 15px 40px;
      border-radius: 25px;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(72, 187, 120, 0.4);
    }

    .restart-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(72, 187, 120, 0.5);
    }

    .powerups {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .powerup {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 10px 16px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
      border: none;
    }

    .powerup:hover:not(.used) {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 6px 20px rgba(240, 147, 251, 0.5);
    }

    .powerup.used {
      opacity: 0.4;
      cursor: not-allowed;
      background: #cbd5e0;
    }

    .powerup.double-points {
      background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
    }

    .powerup.double-points:hover:not(.used) {
      box-shadow: 0 6px 20px rgba(255, 215, 0, 0.5);
    }

    .powerup.active {
      animation: powerupPulse 1s infinite;
    }

    @keyframes powerupPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .hint-box {
      background: #fff3cd;
      border: 2px solid #ffc107;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      animation: slideIn 0.5s ease-out;
      transition: all 0.8s ease;
    }

    body.dark-mode .hint-box {
      background: #2a2a4e;
      border-color: #f093fb;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }

    .hint-icon {
      font-size: 24px;
    }

    .hint-text {
      color: #856404;
      font-size: 15px;
      line-height: 1.5;
      flex: 1;
      transition: all 0.8s ease;
    }

    body.dark-mode .hint-text {
      color: #e0e0e0;
    }

    .round-badge {
      display: inline-block;
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      color: white;
      padding: 8px 20px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 20px;
      box-shadow: 0 4px 10px rgba(255, 107, 107, 0.3);
      animation: bounceIn 0.6s ease-out;
    }

    @keyframes bounceIn {
      0% {
        transform: scale(0.3);
        opacity: 0;
      }
      50% {
        transform: scale(1.05);
      }
      100% {
        transform: scale(1);
        opacity: 1;
      }
    }

    .points-indicator {
      background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
      color: white;
      padding: 6px 14px;
      border-radius: 15px;
      font-size: 13px;
      font-weight: bold;
      display: inline-flex;
      align-items: center;
      gap: 5px;
      animation: pointsGlow 0.5s ease-out;
      transition: all 0.8s ease;
    }

    body.dark-mode .points-indicator {
      background: linear-gradient(135deg, #00d2ff 0%, #3a7bd5 100%);
    }

    @keyframes pointsGlow {
      0% {
        box-shadow: 0 0 0 rgba(72, 187, 120, 0);
      }
      50% {
        box-shadow: 0 0 20px rgba(72, 187, 120, 0.8);
      }
      100% {
        box-shadow: 0 0 0 rgba(72, 187, 120, 0);
      }
    }

    @keyframes scoreGlow {
      0% {
        transform: scale(1);
        text-shadow: 0 0 0 rgba(72, 187, 120, 0);
      }
      50% {
        transform: scale(1.3);
        text-shadow: 0 0 20px rgba(72, 187, 120, 1);
      }
      100% {
        transform: scale(1);
        text-shadow: 0 0 0 rgba(72, 187, 120, 0);
      }
    }

    @keyframes scorePulseRed {
      0% {
        transform: scale(1);
        text-shadow: 0 0 0 rgba(245, 101, 101, 0);
      }
      25% {
        transform: scale(1.15);
        text-shadow: 0 0 15px rgba(245, 101, 101, 1);
      }
      50% {
        transform: scale(0.95);
        text-shadow: 0 0 10px rgba(245, 101, 101, 0.8);
      }
      75% {
        transform: scale(1.05);
        text-shadow: 0 0 15px rgba(245, 101, 101, 1);
      }
      100% {
        transform: scale(1);
        text-shadow: 0 0 0 rgba(245, 101, 101, 0);
      }
    }

    .progress-bar {
      background: #e2e8f0;
      height: 8px;
      border-radius: 10px;
      margin-bottom: 30px;
      overflow: hidden;
      transition: all 0.8s ease;
    }

    body.dark-mode .progress-bar {
      background: #2a2a4e;
    }

    .progress-fill {
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      height: 100%;
      border-radius: 10px;
      transition: width 0.5s ease, background 0.8s ease;
    }

    body.dark-mode .progress-fill {
      background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
    }

    @media (max-width: 640px) {
      body {
        padding: 15px;
      }

      .header h1 {
        font-size: 32px;
        flex-direction: column;
        gap: 10px;
      }

      .header p {
        font-size: 16px;
      }

      .quiz-card {
        padding: 20px;
      }

      .question-text {
        font-size: 18px;
      }

      .option {
        padding: 15px;
        font-size: 15px;
      }

      .result-title {
        font-size: 26px;
      }

      .result-icon {
        font-size: 60px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="volleyball-bg" id="volleyballBg"></div>
  <div class="container">
   <div class="header">
    <h1><span class="volleyball-icon">üèê</span> <span id="mainTitle">Bola Tampar</span></h1>
    <p id="subtitle">Kuiz Kemahiran Asas untuk Tingkatan 1</p>
   </div>
   <div class="progress-bar">
    <div class="progress-fill" id="progressBar"></div>
   </div>
   <div class="quiz-card" id="quizCard">
    <div style="text-align: center;"><span class="round-badge" id="roundBadge">üéØ Pusingan Utama</span>
    </div>
    <div class="powerups" id="powerupsContainer"><button class="powerup hint-powerup" id="hint1" onclick="useHint(1)"> üí° Petunjuk (2) </button> <button class="powerup double-points" id="double1" onclick="useDoublePoints(1)"> ÔøΩÔøΩÔøΩÔøΩÔøΩ Mata Berganda (2) </button>
    </div>
    <div id="hintContainer"></div>
    <div class="question-header"><span class="question-number" id="questionNumber">Soalan 1/10</span>
     <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 5px;"><span class="score" id="scoreDisplay">Skor: 0</span> <span class="points-indicator" id="pointsIndicator">+1 mata</span>
     </div>
    </div>
    <div class="question-text" id="questionText"></div>
    <div class="options" id="optionsContainer"></div><button class="next-button" id="nextButton" disabled>Soalan Seterusnya</button>
   </div>
  </div>
  <script>
    const defaultConfig = {
      quiz_title: "Bola Tampar",
      quiz_subtitle: "Kuiz Kemahiran Asas untuk Tingkatan 1"
    };

    const originalQuizData = [
      {
        question: "Apakah kemahiran yang digunakan untuk menerima servis dan membuat umpanan?",
        options: ["Merejam", "Menyangga", "Mengadang", "Mengumpan"],
        correct: 1,
        hint: "Kemahiran ini melibatkan kedua-dua tangan yang dirapatkan dan lutut yang dibengkokkan untuk menerima bola."
      },
      {
        question: "Semasa menyangga, mata hendaklah fokus kepada _____ dengan kedua-dua tangan dirapatkan.",
        options: ["Jaring", "Bola", "Rakan", "Gelanggang"],
        correct: 1,
        hint: "Fokus adalah penting dalam sukan. Anda perlu melihat objek yang akan anda terima."
      },
      {
        question: "Mengumpan adalah sentuhan yang ke berapa sesuatu pasukan?",
        options: ["Pertama", "Kedua", "Ketiga", "Keempat"],
        correct: 1,
        hint: "Dalam bola tampar, biasanya ada urutan: terima, umpan, kemudian rejam."
      },
      {
        question: "Semasa mengumpan, kedua-dua tangan hendaklah berada di mana?",
        options: ["Di bawah pinggang", "Melebihi paras dahi", "Di paras dada", "Di belakang badan"],
        correct: 1,
        hint: "Tangan perlu berada di atas untuk mengangkat bola ke udara bagi rakan sepassukan."
      },
      {
        question: "Apakah tujuan kemahiran servis dalam permainan bola tampar?",
        options: ["Untuk mengadang bola", "Untuk memulakan permainan", "Untuk menyangga bola", "Untuk mengumpan bola"],
        correct: 1,
        hint: "Servis adalah kemahiran pertama yang dilakukan pada awal setiap mata."
      },
      {
        question: "Dalam servis bawah, bola dilambung pada paras _____ dengan menggunakan tangan bukan dominan.",
        options: ["Kepala", "Dahi", "Dada", "Pinggang"],
        correct: 3,
        hint: "Servis 'bawah' bermaksud lambungan dan pukulan dilakukan di bahagian bawah badan."
      },
      {
        question: "Apakah tujuan kemahiran merejam dilakukan?",
        options: ["Untuk memulakan permainan", "Untuk mematikan bola ke gelanggang pihak lawan", "Untuk menerima servis", "Untuk mengadang bola"],
        correct: 1,
        hint: "Rejaman adalah serangan kuat untuk mendapatkan mata dengan cepat."
      },
      {
        question: "Apakah yang diperlukan dalam menguasai kemahiran merejam?",
        options: ["Kuasa tangan", "Kuasa lompatan", "Kuasa kaki", "Kuasa bahu"],
        correct: 1,
        hint: "Untuk merejam dengan berkesan, pemain perlu melompat tinggi untuk memukul bola dari atas."
      },
      {
        question: "Apakah tujuan kemahiran mengadang?",
        options: ["Untuk menerima servis", "Untuk memulakan permainan", "Untuk menentang rejaman dari pihak lawan", "Untuk membuat umpanan"],
        correct: 2,
        hint: "Adangan adalah kemahiran pertahanan untuk menghalang serangan pihak lawan di jaring."
      },
      {
        question: "Berapa orang pemain dalam setiap pasukan bola tampar?",
        options: ["Lima orang", "Enam orang", "Tujuh orang", "Lapan orang"],
        correct: 1,
        hint: "Dalam bola tampar, pemain disusun dalam dua barisan dengan jumlah yang sama di setiap barisan."
      }
    ];

    let quizData = [];

    let currentQuestion = 0;
    let score = 0;
    let selectedOption = null;
    let answered = false;
    let hintCount = 2;
    let doublePointsCount = 2;
    let isDoublePoints = false;
    let wrongAnswers = [];
    let isRedemptionRound = false;
    let redemptionQuestions = [];
    let redemptionIndex = 0;

    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }

    function createFallingVolleyballs() {
      const container = document.getElementById('volleyballBg');
      for (let i = 0; i < 15; i++) {
        const volleyball = document.createElement('div');
        volleyball.className = 'falling-volleyball';
        volleyball.textContent = 'üèê';
        volleyball.style.left = Math.random() * 100 + '%';
        volleyball.style.animationDuration = (Math.random() * 3 + 4) + 's';
        volleyball.style.animationDelay = Math.random() * 5 + 's';
        container.appendChild(volleyball);
      }
    }

    function createConfetti() {
      const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#45b7d1', '#f093fb', '#4facfe'];
      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = Math.random() * 100 + '%';
        confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.animationDelay = Math.random() * 0.5 + 's';
        confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 3500);
      }
    }

    function useHint(num) {
      if (hintCount <= 0 || answered) return;
      
      hintCount--;
      const button = document.getElementById('hint1');
      button.textContent = `üí° Petunjuk (${hintCount})`;
      if (hintCount === 0) {
        button.classList.add('used');
      }

      const currentQ = isRedemptionRound ? redemptionQuestions[redemptionIndex] : quizData[currentQuestion];
      const hintContainer = document.getElementById('hintContainer');
      hintContainer.innerHTML = `
        <div class="hint-box">
          <span class="hint-icon">üí°</span>
          <span class="hint-text">${currentQ.hint}</span>
        </div>
      `;
    }

    function useDoublePoints(num) {
      if (doublePointsCount <= 0 || answered || isDoublePoints) return;
      
      doublePointsCount--;
      isDoublePoints = true;
      const button = document.getElementById('double1');
      button.textContent = `‚≠ê Mata Berganda (${doublePointsCount})`;
      button.classList.add('active');
      if (doublePointsCount === 0) {
        button.classList.add('used');
      }

      document.getElementById('pointsIndicator').innerHTML = '‚≠ê +2 mata';
    }

    function updateUI() {
      const totalQuestions = isRedemptionRound ? redemptionQuestions.length : quizData.length;
      const currentQ = isRedemptionRound ? redemptionIndex : currentQuestion;
      
      const progress = ((currentQ) / totalQuestions) * 100;
      document.getElementById('progressBar').style.width = progress + '%';
      
      document.getElementById('questionNumber').textContent = `Soalan ${currentQ + 1}/${totalQuestions}`;
      document.getElementById('scoreDisplay').textContent = `Skor: ${score}`;
      
      const question = isRedemptionRound ? redemptionQuestions[redemptionIndex] : quizData[currentQuestion];
      document.getElementById('questionText').textContent = question.question;
      
      document.getElementById('hintContainer').innerHTML = '';
      
      if (isDoublePoints) {
        document.getElementById('pointsIndicator').innerHTML = '‚≠ê +2 mata';
      } else {
        document.getElementById('pointsIndicator').innerHTML = '+1 mata';
      }
      
      const optionsContainer = document.getElementById('optionsContainer');
      optionsContainer.innerHTML = '';
      
      const letters = ['A', 'B', 'C', 'D'];
      question.options.forEach((option, index) => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'option';
        optionDiv.innerHTML = `
          <span class="option-letter">${letters[index]}</span>
          <span>${option}</span>
        `;
        optionDiv.addEventListener('click', () => selectOption(index, optionDiv));
        optionsContainer.appendChild(optionDiv);
      });
      
      selectedOption = null;
      answered = false;
      document.getElementById('nextButton').disabled = true;
    }

    function selectOption(index, element) {
      if (answered) return;
      
      const options = document.querySelectorAll('.option');
      options.forEach(opt => {
        opt.classList.remove('selected');
        opt.classList.add('disabled');
      });
      
      element.classList.add('selected');
      selectedOption = index;
      
      const question = isRedemptionRound ? redemptionQuestions[redemptionIndex] : quizData[currentQuestion];
      const correctAnswer = question.correct;
      
      setTimeout(() => {
        if (index === correctAnswer) {
          element.classList.remove('selected');
          element.classList.add('correct');
          const points = isDoublePoints ? 2 : 1;
          score += points;
          
          const scoreDisplay = document.getElementById('scoreDisplay');
          scoreDisplay.textContent = `Skor: ${score}`;
          
          if (isRedemptionRound) {
            scoreDisplay.style.animation = 'none';
            setTimeout(() => {
              scoreDisplay.style.animation = 'scoreGlow 0.6s ease-out';
            }, 10);
            redemptionQuestions[redemptionIndex].answeredCorrect = true;
          }
        } else {
          element.classList.remove('selected');
          element.classList.add('wrong');
          options[correctAnswer].classList.add('correct');
          
          if (!isRedemptionRound) {
            wrongAnswers.push({
              question: question.question,
              options: question.options,
              correct: question.correct,
              hint: question.hint,
              originalIndex: currentQuestion
            });
          } else {
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.style.animation = 'none';
            setTimeout(() => {
              scoreDisplay.style.animation = 'scorePulseRed 0.6s ease-out';
            }, 10);
          }
        }
        
        answered = true;
        
        const doubleButton = document.getElementById('double1');
        if (isDoublePoints) {
          doubleButton.classList.remove('active');
          isDoublePoints = false;
        }
        
        document.getElementById('nextButton').disabled = false;
      }, 300);
    }

    function nextQuestion() {
      if (isRedemptionRound) {
        redemptionIndex++;
        if (redemptionIndex < redemptionQuestions.length) {
          updateUI();
        } else {
          showFinalResults();
        }
      } else {
        currentQuestion++;
        if (currentQuestion < quizData.length) {
          updateUI();
        } else {
          if (wrongAnswers.length > 0) {
            startRedemptionRound();
          } else {
            showFinalResults();
          }
        }
      }
    }

    function startRedemptionRound() {
      isRedemptionRound = true;
      redemptionQuestions = [...wrongAnswers];
      redemptionIndex = 0;
      
      document.body.classList.add('dark-mode');
      
      document.getElementById('roundBadge').innerHTML = 'üîÑ Pusingan Penebusan';
      document.getElementById('roundBadge').style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
      
      document.getElementById('progressBar').style.width = '0%';
      
      updateUI();
    }

    function showFinalResults() {
      document.body.classList.remove('dark-mode');
      
      const maxPossibleScore = 10;
      const percentage = (score / maxPossibleScore) * 100;
      let icon, title, message;
      
      if (percentage >= 80) {
        icon = 'üèÜ';
        title = 'Hebat Sekali!';
        message = 'Anda telah menguasai kemahiran asas bola tampar dengan cemerlang!';
        createConfetti();
      } else if (percentage >= 60) {
        icon = '‚≠ê';
        title = 'Bagus!';
        message = 'Anda memahami kemahiran asas bola tampar dengan baik. Teruskan usaha!';
        createConfetti();
      } else {
        icon = 'üí™';
        title = 'Cuba Lagi!';
        message = 'Jangan putus asa! Baca semula nota dan cuba sekali lagi.';
      }
      
      document.getElementById('progressBar').style.width = '100%';
      
      const quizCard = document.getElementById('quizCard');
      quizCard.innerHTML = `
        <div class="result-card">
          <div class="result-icon">${icon}</div>
          <div class="result-title">${title}</div>
          <div class="result-score">Skor Anda: ${score}/${maxPossibleScore}</div>
          <div class="result-message">${message}</div>
          <button class="restart-button" onclick="restartQuiz()">üîÑ Cuba Sekali Lagi</button>
        </div>
      `;
    }

    function restartQuiz() {
      currentQuestion = 0;
      score = 0;
      hintCount = 2;
      doublePointsCount = 2;
      isDoublePoints = false;
      wrongAnswers = [];
      isRedemptionRound = false;
      redemptionQuestions = [];
      redemptionIndex = 0;
      
      document.body.classList.remove('dark-mode');
      
      quizData = shuffleArray(originalQuizData);
      
      const quizCard = document.getElementById('quizCard');
      quizCard.innerHTML = `
        <div style="text-align: center;">
          <span class="round-badge" id="roundBadge">üéØ Pusingan Utama</span>
        </div>
        <div class="powerups" id="powerupsContainer">
          <button class="powerup hint-powerup" id="hint1" onclick="useHint(1)">
            üí° Petunjuk (2)
          </button>
          <button class="powerup double-points" id="double1" onclick="useDoublePoints(1)">
            ‚≠ê Mata Berganda (2)
          </button>
        </div>
        <div id="hintContainer"></div>
        <div class="question-header">
          <span class="question-number" id="questionNumber">Soalan 1/10</span>
          <div style="display: flex; flex-direction: column; align-items: flex-end; gap: 5px;">
            <span class="score" id="scoreDisplay">Skor: 0</span>
            <span class="points-indicator" id="pointsIndicator">+1 mata</span>
          </div>
        </div>
        <div class="question-text" id="questionText"></div>
        <div class="options" id="optionsContainer"></div>
        <button class="next-button" id="nextButton" disabled>Soalan Seterusnya</button>
      `;
      document.getElementById('nextButton').addEventListener('click', nextQuestion);
      updateUI();
    }

    quizData = shuffleArray(originalQuizData);
    
    document.getElementById('nextButton').addEventListener('click', nextQuestion);
    
    createFallingVolleyballs();

    async function onConfigChange(config) {
      const quizTitle = config.quiz_title || defaultConfig.quiz_title;
      const subtitle = config.quiz_subtitle || defaultConfig.quiz_subtitle;
      
      document.getElementById('mainTitle').textContent = quizTitle;
      document.getElementById('subtitle').textContent = subtitle;
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (config) => new Map([
          ['quiz_title', config.quiz_title || defaultConfig.quiz_title],
          ['quiz_subtitle', config.quiz_subtitle || defaultConfig.quiz_subtitle]
        ])
      });
    }

    updateUI();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a05cfb4029b8066',t:'MTc2MzQ1MTUzOC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
